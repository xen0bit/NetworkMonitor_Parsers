//#  (c) 2009 CodePlex Foundation
//#
//#  Title:                  Security Account Manager (SAM) Remote Protocol (Client-to-Server)
//#
//#  Details:                
//#
//#  Microsoft References:   [MS-SAMR]: Security Account Manager (SAM) Remote Protocol Specification (Client-to-Server) (17.0)
//#
//#  Comments:               Parser Framework: PAC v2.1.1577.0
//#
//#  Revision Class and Date:Major, 6/25/2009
//#                          Minor, 5/11/2010
//#
//####

Protocol SAMR = FormatString( "%s %s%s%s%s%s", 
	Property.SAMRMethodName,
	Property.MSRPCPType ? "Response" : "Request",
	Property.MSRPCPfcFlags & 0x03 == 0x01 ? ", RPC first fragment" : "",
	Property.MSRPCCompleteFrag == 0 ? ", partial" : "",
	Property.MSRPCEncrypted == ConstEncTypeEncrypted ? ", *Encrypted*" : Property.MSRPCEncrypted == ConstEncTypeUnknown ? "*Un-Interpreted*" : "",
	Property.SAMRSummary && Property.MSRPCEncrypted == ConstEncTypeClearData ? ", " + Property.SAMRSummary : "" )
{
	[Property.SAMRSummary = ""]
	[Property.SAMRMethodName = SAMRMethodNameTable( Property.MSRPCOpnum )]
	Switch( Property.MSRPCOpnum )
	{
		Case 0:
			_Struct SamrConnect
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ServerName=%s DesiredAccess=%u", ServerName.ToString, DesiredAccess )]
									Struct
									{
										NdrPtr ServerNamePtr;
										UnicodeString ServerName;
										Align4 Pad;
										SAMRServerSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 1:
			_Struct SamrCloseHandle
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE SamHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE SamHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 2:
			_Struct SamrSetSecurityObject
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "SecurityInformation=%u", SecurityInformation )]
									Struct
									{
										CONTEXT_HANDLE ObjectHandle;
										SAMRSecurityInformation SecurityInformation;
										SAMRSamprSrSecurityDescriptor SecurityDescriptor;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 3:
			_Struct SamrQuerySecurityObject
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "SecurityInformation=%u", SecurityInformation )]
									Struct
									{
										CONTEXT_HANDLE ObjectHandle;
										SAMRSecurityInformation SecurityInformation;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprSrSecurityDescriptorPtr SecurityDescriptor;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
			
		Case 5:
			_Struct SamrLookupDomainInSamServer
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										NdrUnicodeString Name;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SIDPtr DomainId;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 6:
			_Struct SamrEnumerateDomainsInSamServer
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u PreferedMaximumLength=%u", EnumerationContext, PreferedMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										UINT32 EnumerationContext;
										UINT32 PreferedMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u CountReturned=%u ReturnValue=%d", EnumerationContext, CountReturned, ReturnValue )]
									Struct
									{
										UINT32 EnumerationContext;
										SAMRPSamprEnumerationBufferPtr Buffer;
										Align4 Pad;
										UINT32 CountReturned;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 7:
			_Struct SamrOpenDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u", DesiredAccess )]
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										SAMRDomainSpecificRights DesiredAccess;
										SID(TRUE) DomainID;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 8:
			_Struct SamrQueryInformationDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DomainInformationClass = SAMRDomainInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprDomainInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 9:
			_Struct SamrSetInformationDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DomainInformationClass = SAMRDomainInformationClassTypeTable( this.value, TRUE );
										SAMRSamprDomainInfoBuffer DomainInformation;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 10:
			_Struct SamrCreateGroupInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u", DesiredAccess )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrUnicodeString Name;
										ALign4 Pad;
										SAMRGroupSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "RelativeId=%u ReturnValue=%d", RelativeId, ReturnValue )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 RelativeId;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 11:
			_Struct SamrEnumerateGroupsInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u PreferedMaximumLength=%u", EnumerationContext, PreferedMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 EnumerationContext;
										UINT32 PreferedMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u CountReturned=%u ReturnValue=%d", EnumerationContext, CountReturned, ReturnValue )]
									Struct
									{
										UINT32 EnumerationContext;
										SAMRPSamprEnumerationBufferPtr Buffer;
										Align4 Pad;
										UINT32 CountReturned;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 12:
			_Struct SamrCreateUserInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u", DesiredAccess )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrUnicodeString Name;
										Align4 Pad;
										SAMRUserSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "RelativeId=%u ReturnValue=%d", RelativeId, ReturnValue )]
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										UINT32 RelativeId;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 13:
			_Struct SamrEnumerateUsersInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u UserAccountControl=%u PreferedMaximumLength=%u", EnumerationContext, UserAccountControl, PreferedMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 EnumerationContext;
										SAMRUserAccountControl UserAccountControl;
										UINT32 PreferedMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u CountReturned=%u ReturnValue=%d", EnumerationContext, CountReturned, ReturnValue )]
									Struct
									{
										UINT32 EnumerationContext;
										SAMRPSamprEnumerationBufferPtr Buffer;
										Align4 Pad;
										UINT32 CountReturned;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 14:
			_Struct SamrCreateAliasInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u", DesiredAccess )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrUnicodeString AccountName;
										Align4 Pad;
										SAMRAliasSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "RelativeId=%u ReturnValue=%d", RelativeId, ReturnValue )]
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										UINT32 RelativeId;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 15:
			_Struct SamrEnumerateAliasesInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u PreferedMaximumLength=%u", EnumerationContext, PreferedMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 EnumerationContext;
										UINT32 PreferedMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "EnumerationContext=%u CountReturned=%u ReturnValue=%d", EnumerationContext, CountReturned, ReturnValue )]
									Struct
									{
										UINT32 EnumerationContext;
										SAMRPSamprEnumerationBufferPtr Buffer;
										Align4 Pad;
										UINT32 CountReturned;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 16:
			_Struct SamrGetAliasMembership
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrAlign Pad;
										SAMRSamprPsidArray SidArray;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprUlongUseArray(FALSE) Membership = FormatString( "RID Count: %u", SAMRSamprUseArrayCount );
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 17:
			_Struct SamrLookupNamesInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Count=%u", Count )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 Count;
										SAMRSamprRpcUnicodeString Names;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprUlongUseArray(FALSE) RelativeIds = FormatString( "RID Count: %u", SAMRSamprUseArrayCount );
										NdrAlign Pad;
										SAMRSamprUlongUseArray(TRUE) Use;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 18:
			_Struct SamrLookupIdsInDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Count=%u", Count )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										UINT32 Count;
										Struct RelativeIDs
										{
											NdrConformantVarying Length;
											UINT32 RelativeIds[ Length.ActualCount ];
										}
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprReturnedUstringArray Names;
										NdrAlign Pad;
										SAMRSamprUlongUseArray(TRUE) Use = FormatString( "SIDType Count: %u", SAMRSamprUseArrayCount );
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 19:
			_Struct SamrOpenGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u GroupId=%u", DesiredAccess, GroupId )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										SAMRGroupSpecificRights DesiredAccess;
										UINT32 GroupId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 20:
			_Struct SamrQueryInformationGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										NdrEnum GroupInformationClass = SAMRGroupInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprGroupInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 21:
			_Struct SamrSetInformationGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										NdrEnum GroupInformationClass = SAMRGroupInformationClassTypeTable( this.value, TRUE );
										SAMRSamprGroupInfoBuffer Buffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 22:
			_Struct SamrAddMemberToGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "MemberId=%u Attributes=%u", MemberId, Attributes )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 MemberId;
										SAMRGroupAttributes Attributes;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 23:
			_Struct SamrDeleteGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 24:
			_Struct SamrRemoveMemberFromGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "MemberId=%u", MemberId )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 MemberId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 25:
			_Struct SamrGetMembersInGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprGetMembersBufferIdlStructPtr Members;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 26:
			_Struct SamrSetMemberAttributesOfGroup
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "MemberId=%u Attributes=%u", MemberId, Attributes )]
									Struct
									{
										CONTEXT_HANDLE GroupHandle;
										UINT32 MemberId;
										SAMRGroupAttributes Attributes;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 27:
			_Struct SamrOpenAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u AliasId=%u", DesiredAccess, AliasId )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										SAMRAliasSpecificRights DesiredAccess;
										UINT32 AliasId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 28:
			_Struct SamrQueryInformationAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										NdrEnum AliasInformationClass = SAMRAliasInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprAliasInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 29:
			_Struct SamrSetInformationAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										NdrEnum AliasInformationClass = SAMRAliasInformationClassTypeTable( this.value, TRUE );
										SAMRSamprAliasInfoBuffer Buffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 30:
			_Struct SamrDeleteAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 31:
			_Struct SamrAddMemberToAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										SID( TRUE ) MemberId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 32:
			_Struct SamrRemoveMemberFromAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										SID( TRUE ) MemberId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 33:
			_Struct SamrGetMembersInAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprPsidArray Members;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 34:
			_Struct SamrOpenUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "DesiredAccess=%u UserId=%u", DesiredAccess, UserId )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										SAMRUserSpecificRights DesiredAccess;
										UINT32 UserId;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 35:
			_Struct SamrDeleteUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 36:
			_Struct SamrQueryInformationUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										NdrEnum UserInformationClass = SAMRUserInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprUserInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 37:
			_Struct SamrSetInformationUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										NdrEnum UserInformationClass = SAMRUserInformationClassTypeTable( this.value, TRUE );
										SAMRSamprUserInfoBuffer Buffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 38:
			_Struct SamrChangePasswordUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "LmPresent=%c NtPresent=%c NtCrossEncryptionPresent=%c LmCrossEncryptionPresent=%c", LmPresent, NtPresent, NtCrossEncryptionPresent, LmCrossEncryptionPresent )]
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										BOOLEAN LmPresent;
										SAMREncryptedLmOwfPasswordPtr LmOldEncryptedWithLmNew;
										SAMREncryptedLmOwfPasswordPtr LmNewEncryptedWithLmOld;
										BOOLEAN NtPresent;
										SAMREncryptedLmOwfPasswordPtr NtOldEncryptedWithNtNew;
										SAMREncryptedLmOwfPasswordPtr NtNewEncryptedWithNtOld;
										BOOLEAN NtCrossEncryptionPresent;
										SAMREncryptedLmOwfPasswordPtr NtNewEncryptedWithLmNew;
										BOOLEAN LmCrossEncryptionPresent;
										SAMREncryptedLmOwfPasswordPtr LmNewEncryptedWithNtNew;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 39:
			_Struct SamrGetGroupsForUser
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprGetGroupsBufferPtr Groups;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 40:
			_Struct SamrQueryDisplayInformation
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Index=%u EntryCount=%u PreferredMaximumLength=%u", Index, EntryCount, PreferredMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DisplayInformationClass = SAMRDomainDisplayInformationClassTypeTable( this.value, TRUE );
										Align4 Pad;
										UINT32 Index;
										UINT32 EntryCount;
										UINT32 PreferredMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "TotalAvailable=%u TotalReturned=%u ReturnValue=%d", TotalAvailable, TotalReturned, ReturnValue )]
									Struct
									{
										UINT32 TotalAvailable;
										UINT32 TotalReturned;
										SAMRSamprDisplayInfoBuffer Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 41:
			_Struct SamrGetDisplayEnumerationIndex
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DisplayInformationClass = SamrDomainDisplayInformationClassTypeTable( this.value, TRUE );
										NdrUnicodeString Prefix;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Index=%u ReturnValue=%d", Index, ReturnValue )]
									Struct
									{
										UINT32 Index;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 44:
			_Struct SamrGetUserDomainPasswordInformation
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRUserDomainPasswordInformation PasswordInformation;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 45:
			_Struct SamrRemoveMemberFromForeignDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										SID( TRUE ) MemberSID;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										INT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 46:
			_Struct SamrQueryInformationDomain2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DomainInformationClass = SAMRDomainInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprDomainInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 47:
			_Struct SamrQueryInformationUser2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										NdrEnum UserInformationClass = SAMRUserInformationClassTypeTable( this.value, TRUE );
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamprUserInfoBufferPtr Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 48:
			_Struct SamrQueryDisplayInformation2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Index=%u EntryCount=%u PreferredMaximumLength=%u", Index, EntryCount, PreferredMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DisplayInformationClass = SAMRDomainDisplayInformationClassTypeTable( this.value, TRUE );
										Align4 Pad;
										UINT32 Index;
										UINT32 EntryCount;
										UINT32 PreferredMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "TotalAvailable=%u TotalReturned=%u ReturnValue=%d", TotalAvailable, TotalReturned, ReturnValue )]
									Struct
									{
										UINT32 TotalAvailable;
										UINT32 TotalReturned;
										SAMRSamprDisplayInfoBuffer Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 49:
			_Struct SamrGetDisplayEnumerationIndex2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DisplayInformationClass = SamrDomainDisplayInformationClassTypeTable( this.value, TRUE );
										NdrUnicodeString Prefix;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Index=%u ReturnValue=%d", Index, ReturnValue )]
									Struct
									{
										UINT32 Index;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 50:
			_Struct SamrCreateUser2InDomain
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "AccountType=%u DesiredAccess=%u", AccountType, DesiredAccess )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrUnicodeString Name;
										Align4 Pad;
										SAMRUserAccountControl AccountType;
										SAMRUserSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "GrantedAccess=%u RelativeId=%u ReturnValue=%d", GrantedAccess, RelativeId, ReturnValue )]
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										SAMRUserSpecificRights GrantedAccess;
										UINT32 RelativeId;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 51:
			_Struct SamrQueryDisplayInformation3
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Index=%u EntryCount=%u PreferredMaximumLength=%u", Index, EntryCount, PreferredMaximumLength )]
									Struct
									{
										CONTEXT_HANDLE DomainHandle;
										NdrEnum DisplayInformationClass = SAMRDomainDisplayInformationClassTypeTable( this.value, TRUE );
										Align4 Pad;
										UINT32 Index;
										UINT32 EntryCount;
										UINT32 PreferredMaximumLength;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "TotalAvailable=%u TotalReturned=%u ReturnValue=%d", TotalAvailable, TotalReturned, ReturnValue )]
									Struct
									{
										UINT32 TotalAvailable;
										UINT32 TotalReturned;
										SAMRSamprDisplayInfoBuffer Buffer;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 52:
			_Struct SamrAddMultipleMembersToAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										NdrAlign Pad;
										SAMRSamprPsidArray MembersBuffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 53:
			_Struct SamrRemoveMultipleMembersFromAlias
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE AliasHandle;
										NdrAlign Pad;
										SAMRSamprPsidArray MembersBuffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 54:
			_Struct SamrOemChangePasswordUser2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										SAMRRpcStringPtr ServerName;
										NdrAlign Pad;
										SAMRRpcString UserName;
										SAMRSamprEncryptedUserPasswordPtr NewPasswordEncryptedWithOldLm;
										SAMREncryptedLmOwfPasswordPtr OldLmOwfPasswordEncryptedWithNewLm;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 55:
			_Struct SamrUnicodeChangePasswordUser2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "LmPresent=%c", LmPresent )]
									Struct
									{
										NdrUnicodeStringPtr ServerName;
										NdrUnicodeString UserName;
										SAMRSamprEncryptedUserPasswordPtr NewPasswordEncryptedWithOldNt;
										SAMREncryptedLmOwfPasswordPtr OldNtOwfPasswordEncryptedWithNewNt;
										BOOLEAN LmPresent;
										SAMRSamprEncryptedUserPasswordPtr NewPasswordEncryptedWithOldLm;
										SAMREncryptedLmOwfPasswordPtr OldLmOwfPasswordEncryptedWithNewNt;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 56:
			_Struct SamrGetDomainPasswordInformation
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										NdrUnicodeStringPtr Unused;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRUserDomainPasswordInformation PasswordInformation;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 57:
			_Struct SamrConnect2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ServerName=%s DesiredAccess=%u", ServerName.ToString, DesiredAccess )]
									Struct
									{
										NdrWideStringPtr ServerName;
										Align4 Pad;
										SAMRServerSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 58:
			_Struct SamrSetInformationUser2
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										CONTEXT_HANDLE UserHandle;
										NdrEnum UserInformationClass = SAMRUserInformationClassTypeTable( this.value, TRUE );
										SAMRSamprUserInfoBuffer Buffer;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 62:
			_Struct SamrConnect4
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ServerName=%s ClientRevision=%u DesiredAccess=%u", ServerName.ToString, ClientRevision, DesiredAccess )]
									Struct
									{
										NdrWideStringPtr ServerName;
										Align4 Pad;
										UINT32 ClientRevision = SAMRSamprRevisionInfoV1RevisionTable(this);
										SAMRServerSpecificRights DesiredAccess;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										CONTEXT_HANDLE ServerHandle;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
			
		Case 64:
		_Struct SamrConnect5
		{
			Switch( Property.MSRPCPType )
			{
				Case 0x00: //REQUEST
					_Struct Request
					{
						Switch
						{
							Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
							Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
							Default:
								[SAMRSummary = FormatString( "ServerName=%s DesiredAccess=%u InVersion=%u", ServerName.ToString, DesiredAccess, InVersion )]
								Struct
								{
									NdrWideStringPtr ServerName;
									Align4 Pad;
									SAMRServerSpecificRights DesiredAccess;
									UINT32 InVersion;
									SAMRSamprRevisionInfo InRevisionInfo;
								}
						}
					}
				
				Case 0x02: //RESPONSE
					_Struct Response
					{
						Switch
						{
							Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
							Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
							Default:
								[SAMRSummary = FormatString( "OutVersion=%u ReturnValue=%d", OutVersion, ReturnValue )]
								Struct
								{
									UINT32 OutVersion;
									SAMRSamprRevisionInfo OutRevisionInfo;
									CONTEXT_HANDLE ServerHandle;
									UINT32 ReturnValue = NtStatusTable( this );
								}
						}
					}
			}
		}
		
		Case 65:
			_Struct SamrRidToSid
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "Rid=%u", Rid )]
									Struct
									{
										CONTEXT_HANDLE ObjectHandle;
										UINT32 Rid;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SIDPtr Sid;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 66:
			_Struct SamrSetDSRMPassword
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "UserId=%u", UserId )]
									Struct
									{
										NdrUnicodeStringPtr Unused;
										Align4 Pad;
										UINT32 UserId;
										SAMREncryptedLmOwfPasswordPtr EncryptedNtOwfPassword;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 67:
			_Struct SamrValidatePassword
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						_Struct Request
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									Struct
									{
										SAMRPasswordPolicyValidationType ValidationType;
										SAMRSamValidateInputArg InputArg;
									}
							}
						}
					
					Case 0x02: //RESPONSE
						_Struct Response
						{
							Switch
							{
								Case MSRPCAuthLevel == -1: Blob( FrameLength - FrameOffset ) PartialData = "May Need Reassemble";
								Case Property.MSRPCEncrypted != ConstEncTypeClearData: Blob( FrameLength - FrameOffset ) EncryptedData;
								Default:
									[SAMRSummary = FormatString( "ReturnValue=%d: %s", ReturnValue, NtStatusTable(ReturnValue ) )]
									Struct
									{
										SAMRSamValidateOutputArgPtr OutputArg;
										Align4 Pad;
										UINT32 ReturnValue = NtStatusTable( this );
									}
							}
						}
				}
			}
		
		Case 4:
		Case 42:
		Case 43:
		Case 59:
		Case 60:
		Case 61:
		Case 63:
		Case 68:
		Case 69:
			struct NotUsedOnWire
			{
				Switch( Property.MSRPCPType )
				{
					Case 0x00: //REQUEST
						[SAMRSummary = "OPNUM:" + Property.MSRPCOpnum + " request is Not used on wire"]
						_Struct Request
						{
							ReportParserWarning("SAMR", "Invalid samr method, Opnum:" + Property.MSRPCOpnum) ProtocolWarning;
							Blob(FrameLength - Offset) PayloadData;
						}
					
					Case 0x02: //RESPONSE
						[SAMRSummary = "OPNUM:" + Property.MSRPCOpnum + " response is Not used on wire"]
						_Struct Response
						{
							ReportParserWarning("SAMR", "Invalid samr method, Opnum:" + Property.MSRPCOpnum) ProtocolWarning;
							Blob(FrameLength - Offset) PayloadData;
						}
				}
			}
		
		Default:
			Switch
			{
				case IsValueNone(Property.MSRPCOpnum):
					struct
					{
						Blob( FrameLength - Offset ) data;
						ReportParserWarning("SAMR", "Property MSRPCOpnum is missing") ParserWarning;
					}
				default:
					ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown samr method, Opnum:" + Property.MSRPCOpnum ) UnknownMethod;
			}
	}
}

Table SAMRDomainServerEnableStateTable( Value )
{
	Switch( Value )
	{
		Case 0: "DomainServerEnabled - The server is considered \"enabled\" to the client.";
		Case 1: "DomainServerDisabled - This field is not used.";
		Default:"Unknown";
	}
}

Table SAMRDomainServerRoleTable( Value )
{
	Switch( Value )
	{
		Case 2: "DomainServerRoleBackup - The DC is not the PDC.";
		Case 3: "DomainServerRolePrimary - The DC is the PDC.";
		Default:"Unknown";
	}
}

//
//	_ENCRYPTED_LM_OWF_PASSWORD
//
Struct SAMREncryptedLmOwfPassword
{
	AsciiString(16) Data;
}

Struct SAMREncryptedLmOwfPasswordPtr
{
	NdrPtr EncryptedLmOwfPasswordPtr;
	Switch {
		Case EncryptedLmOwfPasswordPtr.ReferentID != 0:
			SAMREncryptedLmOwfPassword EncryptedLmOwfPassword;
	}
}

//
//	_GROUP_MEMBERSHIP
//
Struct SAMRGroupMembership = FormatString( "RelativeId: %u, Attributes: %s", RelativeId, Attributes.toString )
{
	UINT32 RelativeId;
	SAMRGroupAttributes Attributes;
}

//
//	_OLD_LARGE_INTEGER
//
Struct SAMROldLargeInteger
{
	UINT32 LowPart;
	INT32 HighPart;
}

//
//	_PASSWORD_POLICY_VALIDATION_TYPE
//
Struct SAMRPasswordPolicyValidationType
{
	NdrEnum Value = SAMRPasswordPolicyValidationTypeTable(this);
}

Table SAMRPasswordPolicyValidationTypeTable( Value )
{
	Switch( Value )
	{
		Case 1: "SamValidateAuthentication - Indicates a request to execute the password policy validation performed at logon.";
		Case 2: "SamValidatePasswordChange - Indicates a request to execute the password policy validation performed during a password change request.";
		Case 3: "SamValidatePasswordReset - Indicates a request to execute the password policy validation performed during a password reset.";
		Default:"Unknown";
	}
}

//
//	_SAMPR_ALIAS_INFO_BUFFER
//
Struct SAMRSamprAliasInfoBuffer
{
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad;
	}
	NdrEnum InformationClass = SamrAliasInformationClassTypeTable( this.value, TRUE );
	NdrAlign Pad1;
	switch( InformationClass.value )
	{
		Case 1:SAMRSamprAliasGeneralInformation General;
		Case 2:SAMRSamprAliasNameInformation Name;
		Case 3:SAMRSamprAliasAdmCommentInformation AdminComment;
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

[SamprAliasInformationSummary = FormatString( "AliasAccountName: %s, MemberCount: %u", Name.toString, MemberCount )]
Struct SAMRSamprAliasGeneralInformation
{
	[Post.SamprAliasAccountNameHeader = AliasAccountNameHeader.BufferPtr.ReferentID ? AliasAccountNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader AliasAccountNameHeader;
	UINT32 MemberCount;
	[Post.SamprAdminCommentHeader = AdminCommentHeader.BufferPtr.ReferentID ? AdminCommentHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader AdminCommentHeader;
	Switch 
	{
		Case SamprAliasAccountNameHeader > 0: NdrWideString Name;
	}
	Switch 
	{ 
		Case SamprAdminCommentHeader > 0: NdrWideString AdminComment; 
	}
}

[SamprAliasInformationSummary = FormatString( "Name: %s", Name.toString )]
Struct SAMRSamprAliasNameInformation {
	NdrUnicodeString Name;
}

[SamprAliasInformationSummary = FormatString( "AdminComment: %s", AdminComment.toString )]
Struct SAMRSamprAliasAdmCommentInformation {
	NdrUnicodeString AdminComment;
}

Struct SAMRSamprAliasInfoBufferPtr
{
	NdrPtr SAMRSamprAliasInfoBufferPtr;
	Switch {
		Case SAMRSamprAliasInfoBufferPtr.ReferentID != 0:
			SAMRSamprAliasInfoBuffer SAMRSamprAliasInfoBuffer;
	}
}

//
//	_SAMPR_DISPLAY_INFO_BUFFER
//
[SamprDisplayInformationSummary = ""]
Struct SAMRSamprDisplayInfoBuffer = FormatString( "%s", SAMRDomainDisplayInformationClassTypeTable( DomainDisplayInformation.value,FALSE) )
{
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad1;
	}
	[SamprDomainDisplayInformation = SAMRDomainDisplayInformationClassTypeTable( DomainDisplayInformation.value, FALSE )]
	NdrEnum DomainDisplayInformation = SAMRDomainDisplayInformationClassTypeTable( this.value, TRUE );
	switch( DomainDisplayInformation.value )
	{
		Case 1:
			struct
			{
				NdrAlign Pad;
				SAMRSamprDomainDisplayUserBuffer UserInformation;
			}
		Case 2:
			struct
			{
				NdrAlign Pad;
				SAMRSamprDomainDisplayMachineBuffer MachineInformation;
			}
		Case 3:
			struct
			{
				NdrAlign Pad;
				SAMRSamprDomainDisplayGroupBuffer GroupInformation;
			}
		Case 4:
			struct
			{
				NdrAlign Pad;
				SAMRSamprDomainDisplayOemUserBuffer OemUserInformation;
			}
		Case 5:
			struct
			{
				NdrAlign Pad;
				SAMRSamprDomainDisplayOemGroupBuffer OemGroupInformation;
			}
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

//
//	_SAMPR_DOMAIN_DISPLAY_GROUP
//
Struct SAMRSamprDomainDisplayGroup
{
	NdrAlign Pad;
	UINT32 Index;
	UINT32 RID;
	SAMRGroupAttributes Attributes;
	NdrUnicodeStringHeader AccountNameHeader;
	NdrUnicodeStringHeader AdminCommentHeader;
}

//
//	_SAMPR_DOMAIN_DISPLAY_GROUP_BUFFER
//
[Post.SamprDisplayInformationSummary = FormatString( "Entries: %u",EntriesRead)]// %s, GroupAccountName: %s", EntriesRead, SamprDomainDisplayGroup.toString, SamprDomainDisplayGroupAccountName ? SamprDomainDisplayGroupAccountName : "NULL" )]
Struct SAMRSamprDomainDisplayGroupBuffer = FormatString( "Entries: %u",EntriesRead)
{
	[RpcUnicodeLoop = 0,SamprDomainDisplayGroupArrayLoop = 0]
	UINT32 EntriesRead;
	NdrPtr Pointer;

	Switch
	{
		Case Pointer.ReferentID > 0:
		Struct SAMRSamprDomainDisplayMachineArray = FormatString( "Entries: %u",EntriesRead)
		{
			NdrConformant MaxCount;
			SAMRSamprDomainDisplayGroup SamprDomainDisplayGroup[ EntriesRead ];

			While SamprDomainDisplayMachineWhileLoop[ SamprDomainDisplayGroupArrayLoop < RpcUnicodeLoop ]
			{
				[SamprDomainDisplayGroupArrayLoop = SamprDomainDisplayGroupArrayLoop + 1]
				Switch
				{
					Case (SamprDomainDisplayGroupArrayLoop - 1) % 2 == 0: 
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayGroupArrayLoop - 1] > 0: [SamprDomainDisplayGroupAccountName = AccountName.toString ] NdrWideString AccountName;
					}

					Default:
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayGroupArrayLoop - 1] > 0: [SamprDomainDisplayGroupAdminComment = AdminComment.toString]NdrWideString AdminComment;
					}
				}
			}
		}
	}	
}

//
//	_SAMPR_DOMAIN_DISPLAY_MACHINE
//
Struct SAMRSamprDomainDisplayMachine
{
	NdrAlign Pad;
	UINT32 Index;
	UINT32 RID;
	SAMRUserAccountControl AccountControl;
	NdrUnicodeStringHeader AccountNameHeader;
	NdrUnicodeStringHeader AdminCommentHeader;
}

//
//	_SAMPR_DOMAIN_DISPLAY_MACHINE_BUFFER
//
[Post.SamprDisplayInformationSummary = FormatString( "Entries: %u",EntriesRead)]// %s, MachineName: %s", EntriesRead, SamprDomainDisplayMachine.toString, SamprDomainDisplayMachineName ? SamprDomainDisplayMachineName : "NULL" )]
Struct SAMRSamprDomainDisplayMachineBuffer = FormatString( "Entries: %u",EntriesRead)
{
	[RpcUnicodeLoop = 0, SamprDomainDisplayMachineArrayLoop = 0]
	UINT32 EntriesRead;
	NdrPtr Pointer;

	Switch
	{
		Case Pointer.ReferentID > 0:
		Struct SamprDomainDisplayMachineArray = FormatString( "Entries: %u",EntriesRead)
		{
			NdrConformant MaxCount;
			SAMRSamprDomainDisplayMachine SamprDomainDisplayMachine[EntriesRead];

			While SamprDomainDisplayMachineWhileLoop[SamprDomainDisplayMachineArrayLoop < RpcUnicodeLoop ]
			{
				[SamprDomainDisplayMachineArrayLoop = SamprDomainDisplayMachineArrayLoop + 1]
				Switch
				{
					Case (SamprDomainDisplayMachineArrayLoop - 1) % 2 == 0: 
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayMachineArrayLoop - 1] > 0: [SamprDomainDisplayMachineName = AccountName.toString] NdrWideString AccountName;
					}

					Default:
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayMachineArrayLoop - 1] > 0: [SamprDomainDisplayAdminComment = AdminComment.toString] NdrWideString AdminComment;
					}
				}
			}
		}
	}
}

//
//	SAMPR_DOMAIN_DISPLAY_OEM_GROUP
//	Alignment: None
//
Struct SAMRSamprDomainDisplayOemGroup = FormatString("Index: %u",Index)
{
	NdrAlign Pad;
	UINT32 Index;
	NdrUnicodeStringHeader OemAccountName;
}

//
//	_SAMPR_DOMAIN_DISPLAY_OEM_GROUP_BUFFER
//
[Post.SamprDisplayInformationSummary = FormatString( "Entries: %u",EntriesRead)]// %s, GroupAccountName: %s", EntriesRead, SamprDomainDisplayOemGroupArray.toString, SamprDomainDisplayOemGroupAccountName ? SamprDomainDisplayOemGroupAccountName : "NULL" )]
Struct SAMRSamprDomainDisplayOemGroupBuffer = FormatString( "Entries: %u",EntriesRead)
{
	[RpcUnicodeLoop = 0, SamprDomainDisplayOemGroupArrayLoop = 0]
	UINT32 EntriesRead;
	NdrPtr Pointer;
	Switch 
	{
		Case Pointer.ReferentID > 0:
		Struct SamprDomainDisplayOemGroup = FormatString( "Entries: %u",EntriesRead)
		{
			NdrConformant MaxCount;
			SAMRSamprDomainDisplayOemGroup SamprDomainDisplayOemGroup[ EntriesRead ];
			[MaxLoopCount = RpcUnicodeLoop]
			While SamprDomainDisplayOemGroupArrayWhileLoop[ SamprDomainDisplayOemGroupArrayLoop < RpcUnicodeLoop ]
			{
				[SamprDomainDisplayOemGroupArrayLoop = SamprDomainDisplayOemGroupArrayLoop + 1]
				Switch {
					Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayOemGroupArrayLoop - 1] > 0: [SamprDomainDisplayOemGroupAccountName = GroupAccountName.toString]NdrWideString GroupAccountName;
				}
			}
		}
	}
}

//
//	_SAMPR_DOMAIN_DISPLAY_OEM_USER
//	Alignment: None
//
Struct SAMRSamprDomainDisplayOemUser
{
	NdrAlign Pad;
	UINT32 Index;
	NdrUnicodeStringHeader	OemAccountName;
}

//
//	_SAMPR_DOMAIN_DISPLAY_OEM_USER_BUFFER
//
[Post.SamprDisplayInformationSummary = FormatString( "Entries: %u",EntriesRead)]// %s, AccountName: %s", EntriesRead, SamprDomainDisplayOemUserArray.toString, SamprDomainDisplayOemUserAccountName ? SamprDomainDisplayOemUserAccountName : "NULL" )]
Struct SAMRSamprDomainDisplayOemUserBuffer = FormatString( "Entries: %u",EntriesRead)
{
	[RpcUnicodeLoop = 0,SamprDomainDisplayOemUserArrayLoop = 0]
	UINT32 EntriesRead;
	NdrPtr Pointer;
	Switch {
		Case Pointer.ReferentID > 0:
		Struct SamprDomainDisplayOemUser = FormatString( "Entries: %u",EntriesRead)
		{
			NdrConformant MaxCount;
			SAMRSamprDomainDisplayOemUser SamprDomainDisplayOemUser[ EntriesRead ];
			[MaxLoopCount = RpcUnicodeLoop]
			While SamprDomainDisplayOemUserArrayWhileLoop[ SamprDomainDisplayOemUserArrayLoop < RpcUnicodeLoop ]
			{
				[SamprDomainDisplayOemUserArrayLoop = SamprDomainDisplayOemUserArrayLoop + 1]
				Switch
				{
					Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayOemUserArrayLoop - 1] > 0: [SamprDomainDisplayOemUserAccountName = OemAccountName.toString]NdrString OemAccountName;
				}
			}
		}
	}
}

//
//	_SAMPR_DOMAIN_DISPLAY_USER
//
Struct SAMRSamprDomainDisplayUser
{
	NdrAlign Pad;
	UINT32 Index;
	UINT32 RID;
	SAMRUserAccountControl AccountControl;	
	NdrUnicodeStringHeader AccountNameeader;	
	NdrUnicodeStringHeader AdminCommentHeader;	
	NdrUnicodeStringHeader FullNameHeader;
}

//
//	_SAMPR_DOMAIN_DISPLAY_USER_BUFFER
//
Struct SAMRSamprDomainDisplayUserBuffer
{
	[RpcUnicodeLoop = 0, SamprDomainDisplayUserCount = 0]
	UINT32 EntriesRead;
	NdrPtr Pointer;
	Switch {
		Case Pointer.ReferentID > 0:
		//PSAMPR_DOMAIN_DISPLAY_USER
		Struct Buffer = FormatString( "Entries: %u",EntriesRead)
		{
			NdrConformant MaxCount;
			SAMRSamprDomainDisplayUser DomainDisplayUser[ EntriesRead ];
			[MaxLoopCount = RpcUnicodeLoop]
			While SamprDomainDisplayUserWhileLoop[SamprDomainDisplayUserCount < RpcUnicodeLoop]
			{
				[SamprDomainDisplayUserCount = SamprDomainDisplayUserCount + 1]
				Switch
				{
					Case (SamprDomainDisplayUserCount - 1) % 3 == 0:
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayUserCount - 1] > 0: [SamprLogonName = AccountName.toString] NdrWideString AccountName;
					}

					Case (SamprDomainDisplayUserCount - 1) % 3 == 1:
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayUserCount - 1] > 0: [SamprAdminComment = AdminComment.toString] NdrWideString AdminComment;
					}

					Case (SamprDomainDisplayUserCount - 1) % 3 == 2:
					Switch {
						Case NdrUnicodeStringHeaderArray$[SamprDomainDisplayUserCount - 1] > 0: [SamprFullName = FullName.toString] NdrWideString FullName;
					}
				}
			}
		}
	}
}

//
//	_SAMPR_DOMAIN_INFO_BUFFER
//	
Struct SAMRSamprDomainInfoBuffer
{
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad1;
	}
	NdrEnum DomainInformationClass = SamrDomainInformationClassTypeTable( this.value, TRUE );
	NdrAlign PadUnion;
	Switch( DomainInformationClass.value )
	{
		Case 1: SAMRDomainPasswordInformation Password;
			
		Case 2:SAMRSamprDomainGeneralInformation General;
			
		Case 3:SAMRDomainLogoffInformation Logoff;
		Case 4:	SAMRSamprDomainOEMInformation Oem;
		Case 5:SAMRSamprDomainNameInformation Name;
		Case 6:SAMRSamprDomainReplicationInformation Replication;
		Case 7:SAMRDomainServerRoleInformation Role;
		Case 8:
			struct
			{
				Align4 Pad;
				SAMRDomainModifiedInformation Modified;
			}
		Case 9: SAMRDomainStateInformation State;
		Case 11:SAMRSamprDomainGeneralInformation2 General2;
		Case 12:SAMRSamprDomainLockoutInformation Lockout;
		Case 13:SAMRDomainModifiedInformation2 Modified2;
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

//
//	DOMAIN_PASSWORD_INFORMATION
//	Alignment: 4
//
[SamprDomainInformationSummary = FormatString( "MaxPasswordAge: %s, MinPasswordAge: %s, PasswordProperties: %s", MaxPasswordAge.toString, MinPasswordAge.toString, PasswordProperties.toString )]
Struct SAMRDomainPasswordInformation = FormatString( "MaxPasswordAge: %s, MinPasswordAge: %s, PasswordProperties: %s", MaxPasswordAge.toString, MinPasswordAge.toString, PasswordProperties.toString)
{
	UINT16 MinPasswordLength;
	UINT16 PasswordHistoryLength;
	SAMRPasswordProperties PasswordProperties;
	SAMROLDLARGEINTEGER MaxPasswordAge = FormatString("%I64d seconds",INT64(FrameData,FrameOffset)/(10000000));
	SAMROLDLARGEINTEGER MinPasswordAge = FormatString("%I64d seconds",INT64(FrameData,FrameOffset)/(10000000));
}

//
//  SAMPR_DOMAIN_GENERAL_INFORMATION
//	Alignment: Ndr
//
[SamprDomainInformationSummary = FormatString( "OemInformation: %s, DomainName: %s, DomainServerState: %s, DomainServerRole: %s", OemInformation.toString, DomainName.toString, SamrDomainServerStateTable( DomainServerState ), SamrDomainServerRoleTable( DomainServerRole) )]
Struct SAMRSamprDomainGeneralInformation = SamprDomainInformationSummary
{
	SAMROLDLARGEINTEGER ForceLogoff;
	[Post.SamprOemInformationHeader = OemInformationHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader OemInformationHeader;
	[Post.SamprDomainNameHeader = DomainNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader DomainNameHeader;
	[Post.SamprReplicaSourceNodeNameHeader = ReplicaSourceNodeNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ReplicaSourceNodeNameHeader;
	SAMROLDLARGEINTEGER DomainModifiedCount;
	UINT32 DomainServerState = SamrDomainServerStateTable( this );
	UINT32 DomainServerRole = SamrDomainServerRoleTable( this );
	BOOLEAN  UasCompatibilityRequired;
	Align4 Pad;
	UINT32 UserCount;
	UINT32 GroupCount;
	UINT32 AliasCount;
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad1;
	}
	Switch {
		Case SamprOemInformationHeader > 0: NdrWideString OemInformation;
	}
	Switch {
		Case SamprDomainNameHeader > 0: NdrWideString DomainName;
	}
	Switch {
		Case SamprReplicaSourceNodeNameHeader > 0: NdrWideString ReplicaSourceNodeName;
	}
}

//
//  DOMAIN_LOGOFF_INFORMATION
//	Alignment: 4
//
[SamprDomainInformationSummary = FormatString( "ForceLogoff: %s",ForceLogoff.toString )]
Struct SAMRDomainLogoffInformation = SamprDomainInformationSummary 
{
	SAMROLDLARGEINTEGER ForceLogoff;
}

//
//  SAMPR_DOMAIN_OEM_INFORMATION
//  Alignment: No
//
[SamprDomainInformationSummary = FormatString( "OemInformation: %s", OemInformation.toString )]
Struct SAMRSamprDomainOEMInformation  = SamprDomainInformationSummary 
{
	NdrUnicodeString OemInformation;
}

//
//  SAMPR_DOMAIN_NAME_INFORMATION
//  Alignment: No
//
[SamprDomainInformationSummary = FormatString( "DomainName: %s",DomainName.toString )]
Struct SAMRSamprDomainNameInformation = SamprDomainInformationSummary 
{
	NdrUnicodeString DomainName;
}

//
//  SAMPR_DOMAIN_REPLICATION_INFORMATION
//  Alignment: No
//
[SamprDomainInformationSummary = FormatString( "ReplicaSourceNodeName: %s", ReplicaSourceNodeName.toString )]
Struct SAMRSamprDomainReplicationInformation = SamprDomainInformationSummary 
{
	NdrUnicodeString ReplicaSourceNodeName;
}

//
//  DOMAIN_SERVER_ROLE_INFORMATION
//  Alignment: None
//
[SamprDomainInformationSummary = FormatString( "DomainServerRole: %s", SamrDomainServerRoleTable( DomainServerRole ) )]
Struct SAMRDomainServerRoleInformation = SamprDomainInformationSummary
{
	NdrEnum DomainServerRole = SAMRDomainServerRoleTable( this.Value);
}

//
//  DOMAIN_MODIFIED_INFORMATION
//  Alignment: 4
//
[SamprDomainInformationSummary = FormatString( "DomainModifiedCount: %u, CreationTime: %s", DomainModifiedCount, CreationTime.toString )]
Struct SAMRDomainModifiedInformation = SamprDomainInformationSummary  
{
	SAMROLDLARGEINTEGER DomainModifiedCount;
	FILETIME CreationTime;
}

//
//  DOMAIN_MODIFIED_INFORMATION2
//  Alignment: 4
//
[SamprDomainInformationSummary = FormatString( "DomainModifiedCount: %u, CreationTime: %s, ModifiedCountAtLastPromotion: %u", DomainModifiedCount, CreationTime.toString, ModifiedCountAtLastPromotion )]
Struct SAMRDomainModifiedInformation2 = SamprDomainInformationSummary
{
	SAMROLDLARGEINTEGER DomainModifiedCount;
	FILETIME CreationTime;
	SAMROLDLARGEINTEGER ModifiedCountAtLastPromotion;
}

//
//  DOMAIN_STATE_INFORMATION
//  Alignment: None
//
[SamprDomainInformationSummary = FormatString( "DomainServerState: %s", SamrDomainServerStateTable( DomainServerState ) )]
Struct SAMRDomainStateInformation  = SamprDomainInformationSummary
{
	NdrEnum DomainServerState = SAMRDomainServerStateTable( this.Value );
}

Table SAMRDomainServerStateTable( Value )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "0x%04X - Domain server is enabled", Value );
		Case 0x0002: FormatString( "0x%04X - Domain server is disabled", Value );
		Default    : FormatString( "0x%04X - No Description Available", Value );
	}
}

//
//  SAMPR_DOMAIN_GENERAL_INFORMATION2
//  Alignment: NDR
//
[SamprDomainInformationSummary = FormatString( "OemInformation: %s, DomainName: %s, DomainServerState: %s, DomainServerRole: %s", OemInformation.toString, DomainName.toString, SamrDomainServerStateTable( DomainServerState ), SamrDomainServerRoleTable( DomainServerRole) )]
Struct SAMRSamprDomainGeneralInformation2 = SamprDomainInformationSummary
{
	SAMROLDLARGEINTEGER ForceLogoff;
	[Post.SamprOemInformationHeader = OemInformationHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader OemInformationHeader;
	[Post.SamprDomainNameHeader = DomainNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader DomainNameHeader;
	[Post.SamprReplicaSourceNodeNameHeader = ReplicaSourceNodeNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ReplicaSourceNodeNameHeader;
	SAMROLDLARGEINTEGER DomainModifiedCount;
	UINT32 DomainServerState = SamrDomainServerStateTable( this );
	UINT32 DomainServerRole = SamrDomainServerRoleTable( this );
	BOOLEAN UasCompatibilityRequired;
	Align4 Pad;
	UINT32 UserCount;
	UINT32 GroupCount;
	UINT32 AliasCount;
	INT64 LockoutDuration;
	INT64 LockoutObservationWindow;
	UINT16 LockoutThreshold;
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad1;
	}
	Switch {
		Case SamprOemInformationHeader > 0: NdrWideString OemInformation;
	}
	Switch {
		Case SamprDomainNameHeader > 0: NdrWideString DomainName;
	}
	Switch {
		Case SamprReplicaSourceNodeNameHeader > 0: NdrWideString ReplicaSourceNodeName;
	}
}

//
//  SAMPR_DOMAIN_LOCKOUT_INFORMATION
//  Alignment: 8
//
[SamprDomainInformationSummary = FormatString( "LockoutDuration: %s, LockoutObservationWindow: %s", LockoutDuration.toString, LockoutObservationWindow.toString )]
Struct SAMRSamprDomainLockoutInformation = SamprDomainInformationSummary 
{
	INT64 LockoutDuration;
	INT64 LockoutObservationWindow;
	UINT16 LockoutThreshold = FormatString("%u - %s",this, this?"Lockout":"No lockout");
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad;
	}
}

Struct SAMRSamprDomainInfoBufferPtr
{
	NdrPtr SAMRSamprDomainInfoBufferPtr;
	Switch {
		Case SAMRSamprDomainInfoBufferPtr.ReferentID != 0:
			SAMRSamprDomainInfoBuffer SAMRSamprDomainInfoBuffer;
	}
}

//
//	_SAMPR_ENCRYPTED_USER_PASSWORD
//
Struct SAMRSamprEncryptedUserPassword
{
	AsciiString(516) Buffer;
}

//
//	_SAMPR_ENCRYPTED_USER_PASSWORD_NEW
//
Struct SAMRSamprEncryptedUserPasswordNew
{
	AsciiString(532) Buffer;
}

Struct SAMRSamprEncryptedUserPasswordPtr
{
	NdrPtr SAMRSamprEncryptedUserPasswordPtr;
	Switch {
		Case SAMRSamprEncryptedUserPasswordPtr.ReferentID != 0:
			SAMRSamprEncryptedUserPassword SAMRSamprEncryptedUserPassword;
	}
}

//
//	_SAMPR_GET_GROUPS_BUFFER
//
Struct SAMRSamprGetGroupsBuffer
{
	UINT32 MembershipCount;
	NdrPtrToConformant PointerToGroupsArray;
	Switch {
		Case PointerToGroupsArray.ReferentID > 0: SAMRGroupMembership Groups[ MembershipCount ];
	}
}

Struct SAMRSamprGetGroupsBufferPtr
{
	NdrPtr SAMRSamprGetGroupsBufferPtr;
	Switch {
		Case SAMRSamprGetGroupsBufferPtr.ReferentID != 0:
			SAMRSamprGetGroupsBuffer SAMRSamprGetGroupsBuffer;
	}
}

//
//	_SAMPR_GET_MEMBERS_BUFFER
//
Struct SAMRSamprGetMembersBufferIdlStructPtr
{
	NdrPtr Pointer;
	Switch
	{
		Case Pointer.ReferentID > 0:
		Struct
		{
			UINT32 MemberCount;
			[Post.SamprMemberArrayPointer = MemberArrayPointer.ReferentID]
			NdrPtr MemberArrayPointer;
			[Post.SamprAttributesArrayPointer = AttributesArrayPointer.ReferentID]
			NdrPtr AttributesArrayPointer;

			Switch
			{
				Case SamprMemberArrayPointer > 0: 
				Struct Members = FormatString("Count: %u",Size.MaxCount)
				{
					NdrConformant Size;
					UINT32 Members[ Size.MaxCount ];
				}
			}

			Switch
			{
				Case SamprAttributesArrayPointer > 0:
				Struct Attributes = FormatString("Count: %u",Size.MaxCount)
				{
					NdrConformant Size;
					SAMRUserAllValues Attributes[ Size.MaxCount ];
				}
			}
		}
	}
}

Struct SAMRUserAllValues = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT32 Values = FormatString( "0x%08X", this )
			{
				UINT32 Username:1 = FormatString("           (%s) ", this.ToBitString);
				UINT32 FullName:1 = FormatString("           (%s) ", this.ToBitString);
				UINT32 UserID:1 = FormatString("             (%s) ", this.ToBitString);
				UINT32 PrimaryGroupID:1 = FormatString("     (%s) ", this.ToBitString);
				UINT32 AdminComment:1 = FormatString("       (%s) ", this.ToBitString);
				UINT32 UserComment:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 HomeDirectory:1 = FormatString("      (%s) ", this.ToBitString);
				UINT32 HomeDirectoryDrive:1 = FormatString(" (%s) ", this.ToBitString);
				UINT32 ScriptPath:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 ProfilePath:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 WorkStation:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 LastLogon:1 = FormatString("          (%s) ", this.ToBitString);
				UINT32 LastLogoff:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 LogonHours:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 BadPasswordCount:1 = FormatString("   (%s) ", this.ToBitString);
				UINT32 LogonCount:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 PasswordCanChange:1 = FormatString("  (%s) ", this.ToBitString);
				UINT32 PasswordMustChange:1 = FormatString(" (%s) ", this.ToBitString);			
				UINT32 PasswordLastSet:1 = FormatString("    (%s) ", this.ToBitString);
				UINT32 AccountExpires:1 = FormatString("     (%s) ", this.ToBitString);
				UINT32 UserAccountControl:1 = FormatString(" (%s) ", this.ToBitString);
				UINT32 Parameters:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 CountryCode:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 CodePage:1 = FormatString("           (%s) ", this.ToBitString);
				UINT32 NtPasswordPresent:1 = FormatString("  (%s) ", this.ToBitString);
				UINT32 LmPasswordPresent:1 = FormatString("  (%s) ", this.ToBitString);	
				UINT32 Reserved1:1 = FormatString("          (%s) ", this.ToBitString);
				UINT32 PasswordExpired:1 = FormatString("    (%s) ", this.ToBitString);	
				UINT32 Reserved2:4 = FormatString("          (%s) ", this.ToBitString);	
			}
		}
		Default:
		Struct
		{
			UINT32 Attributes = FormatString( "0x%08X", this )
			{
				UINT32 Reserved2:4 = FormatString("          (%s) ", this.ToBitString);
				UINT32 PasswordExpired:1 = FormatString("    (%s) ", this.ToBitString);
				UINT32 Reserved1:1 = FormatString("          (%s) ", this.ToBitString);
				UINT32 LmPasswordPresent:1 = FormatString("  (%s) ", this.ToBitString);
				UINT32 NtPasswordPresent:1 = FormatString("  (%s) ", this.ToBitString);
				UINT32 CodePage:1 = FormatString("           (%s) ", this.ToBitString);
				UINT32 CountryCode:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 Parameters:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 UserAccountControl:1 = FormatString(" (%s) ", this.ToBitString);
				UINT32 AccountExpires:1 = FormatString("     (%s) ", this.ToBitString);
				UINT32 PasswordLastSet:1 = FormatString("    (%s) ", this.ToBitString);	
				UINT32 PasswordMustChange:1 = FormatString(" (%s) ", this.ToBitString);
				UINT32 PasswordCanChange:1 = FormatString("  (%s) ", this.ToBitString);
				UINT32 LogonCount:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 BadPasswordCount:1 = FormatString("   (%s) ", this.ToBitString);
				UINT32 LogonHours:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 LastLogoff:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 LastLogon:1 = FormatString("          (%s) ", this.ToBitString);
				UINT32 WorkStation:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 ProfilePath:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 ScriptPath:1 = FormatString("         (%s) ", this.ToBitString);
				UINT32 HomeDirectoryDrive:1 = FormatString(" (%s) ", this.ToBitString);
				UINT32 HomeDirectory:1 = FormatString("      (%s) ", this.ToBitString);
				UINT32 UserComment:1 = FormatString("        (%s) ", this.ToBitString);
				UINT32 AdminComment:1 = FormatString("       (%s) ", this.ToBitString);
				UINT32 PrimaryGroupID:1 = FormatString("     (%s) ", this.ToBitString);
				UINT32 UserID:1 = FormatString("             (%s) ", this.ToBitString);
				UINT32 FullName:1 = FormatString("           (%s) ", this.ToBitString);	
				UINT32 Username:1 = FormatString("           (%s) ", this.ToBitString);
			}
		}
	}
}

//
//	SAMPR_GROUP_INFO_BUFFER
//
[SamprGroupInformationSummary = ""]
Struct SAMRSamprGroupInfoBuffer = FormatString( "GroupInformationClass: %s", SamrGroupInformationClassTypeTable( GroupInformationClass.value, FALSE ) )
{
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad;
	}
	[Post.SAMRSamprGroupInformationClass = SamrGroupInformationClassTypeTable( this.value, FALSE )]
	NdrEnum GroupInformationClass = SamrGroupInformationClassTypeTable( this.value, TRUE );
	NdrAlign pad2;
	Switch( GroupInformationClass.value )
	{
		Case 1:	SAMRSamprGroupGeneralInformation General;
		Case 2:
		[SamprGroupInformationSummary = FormatString( "%s, GroupAccountName: %s", SAMRSamprGroupInformationClass, Name.toString )]
		Struct SAMRSamprGroupNameInformation {
			NdrUnicodeString Name;
		}
		Case 3:
		[SamprGroupInformationSummary = FormatString( "%s, GroupAttributes: %s", SAMRSamprGroupInformationClass, Attribute.toString )]
		Struct GroupAttributeInformation 
		{
			SAMRGroupAttributes Attribute;
		}
		Case 4:
		[SamprGroupInformationSummary = FormatString( "%s, AdminComment: %s", SAMRSamprGroupInformationClass, AdminComment.toString )]
		Struct SAMRSamprGroupAdmCommentInformation 
		{
			NdrUnicodeString AdminComment;
		}
		Case 5: SAMRSamprGroupGeneralInformation DoNotUse;
	}
}

Struct SAMRSamprGroupInfoBufferPtr
{
	NdrPtr SAMRSamprGroupInfoBufferPtr;
	Switch {
		Case SAMRSamprGroupInfoBufferPtr.ReferentID != 0:
			SAMRSamprGroupInfoBuffer SAMRSamprGroupInfoBuffer;
	}
}

//
//	_SAMPR_PSID_ARRAY
//
Struct SAMRSamprPsidArray = FormatString( "Count: %u", Count )
{
	[Property.SamprSidCount = Count]
	UINT32 Count;
	SAMRSamprSIDInformation Sids;
}

//
//SAMPR_SID_INFORMATION
//
Struct SAMRSamprSIDInformation = FormatString( "Count: %u", Property.SamprSidCount )
{
	[SamprSidPointerLoop = 0, SamprSidPointerArrayLoop = 0, Post.SamprSidArrayCount = Property.SamprSidCount]
	NdrPtrToConformant ArrayPointer;
	Switch
	{
		Case ArrayPointer.ReferentID > 0:
		Struct
		{
			SAMRSamprPSidPointerArray SecurityIdentifierPointer[ Property.SamprSidCount ];
			While SamprSidArrayWhileLoop[SamprSidPointerLoop < SamprSidPointerArrayLoop]
			{
				[SamprSidPointerLoop = SamprSidPointerLoop + 1]
				Switch {
					Case SamprSidPointerArray$[SamprSidPointerLoop - 1] > 0: SID (TRUE) SecurityIdentifiers;
				}
			}
		}
	}
}

Struct SAMRSamprPSidPointerArray  = FormatString("%s",SecurityIdentifierPointer)
{
	[SamprSidPointerArray$[ SamprSidPointerArrayLoop ] = SecurityIdentifierPointer.ReferentID, Post.SamprSidPointerArrayLoop = SamprSidPointerArrayLoop + 1]
	NdrPtr SecurityIdentifierPointer;
}

//
//	SAMPR_RETURNED_USTRING_ARRAY
//	Alignment: NdrAlign
//
Struct SAMRSamprReturnedUStringArray = FormatString( "Count: %u", Count )
{
	UINT32 Count;
	NdrPtrToConformant Pointer;
	Switch {
		Case Pointer.ReferentID > 0: SAMRSamprUnicodeStringArray( Count ) Names;
	}
}

//
//	Sampr_REVISION_INFO
//
Struct SAMRSamprRevisionInfo = FormatString( "Revision: %u", RevsionInfoV1.Revision )
{
	UINT32 InVersion;
	Switch( InVersion )
	{
		Case 1:
			Struct
			{
				Align4 Pad;
				SAMRSamprRevisionInfoV1 RevsionInfoV1;
			}
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

//
//	_SAMPR_REVISION_INFO_V1
//
Struct SAMRSamprRevisionInfoV1
{
	UINT32 Revision = SAMRSamprRevisionInfoV1RevisionTable(this);
	switch( Property.MSRPCByteOrder )
	{
		case LittleEndian:
			struct
			{
					UINT32 SupportedFeatures = FormatString( "0x%08X", this )
					{
						UINT32 SamExtendedSidDomain:1 = FormatString("       (%s) %s", this.ToBitString,this?"Any relative identifier (RID) that is returned by SAM can NOT be treated as part of an account's security identifier (SID)":"Any relative identifier (RID) that is returned by SAM can be treated as part of an account's security identifier (SID)");
						UINT32 SamExtendedSidDomainCompat1:1 = FormatString("(%s) %s", this.ToBitString,"Not Used");
						UINT32 SamExtendedSidDomainCompat2:1 = FormatString("(%s) %s", this.ToBitString,"Not Used");
						UINT32 Reserved:29 = FormatString("                   (%s)", this.ToBitString);
					}
			}
		default:
			struct
			{
				UINT32 SupportedFeatures = FormatString( "0x%08X", this )
				{
					UINT32 Reserved:29 = FormatString("                   (%s)", this.ToBitString);
					UINT32 SamExtendedSidDomainCompat2:1 = FormatString("(%s) %s", this.ToBitString,"Not Used");
					UINT32 SamExtendedSidDomainCompat1:1 = FormatString("(%s) %s", this.ToBitString,"Not Used");
					UINT32 SamExtendedSidDomain:1 = FormatString("       (%s) %s", this.ToBitString,this?"Any relative identifier (RID) that is returned by SAM can NOT be treated as part of an account's security identifier (SID)":"Any relative identifier (RID) that is returned by SAM can be treated as part of an account's security identifier (SID)");
				}
			
			}
	}
}

Table SAMRSamprRevisionInfoV1RevisionTable( Value )
{
	Switch( Value )
	{
		Case 1: "1 - PreWindows 2000";
		Case 2: "2 - Windows 2000";
		Case 3: "3 - Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008, Windows 7, and Windows Server 2008 R2";
		Default: "Unknown";
	}
}

//
//	_SAMPR_SR_SECURITY_DESCRIPTOR
//
Struct SAMRSamprSrSecurityDescriptor
{
	UINT32 Length;
	NdrPtrToConformant ArrayPointer;
	Switch
	{
		Case ArrayPointer.ReferentID > 0:NdrSecurityDescriptor SecurityDescriptor;
	}
}

Struct SAMRSamprSrSecurityDescriptorPtr
{
	NdrPtr SAMRSamprSrSecurityDescriptorPtr;
	Switch {
		Case SAMRSamprSrSecurityDescriptorPtr.ReferentID != 0:
			SAMRSamprSrSecurityDescriptor SAMRSamprSrSecurityDescriptor;
	}
}

//
//	_SAMPR_USER_INFO_BUFFER
//	Alignment: NdrAlign
//
[SamprUserInformationSummary = ""]
Struct SAMRSamprUserInfoBuffer = FormatString( "UserInformationClass: %s", SamrUserInformationClassTypeTable( UserInformationClass.value, FALSE ) )
{
	Switch
	{
		case Property.MSRPCNdr64:
		Align8 pad;
	}
	NdrEnum UserInformationClass = SamrUserInformationClassTypeTable( this.value, TRUE );
	NdrAlign PadUnion;
	switch( UserInformationClass.value )
	{
		Case 1: SAMRSamprUserGeneralInformation General;
		Case 2: SAMRSamprUserPreferencesInformation Preferences;
		Case 3: SAMRSamprUserLogonInformation Logon;
		Case 4:SAMRSamprUserLogonHoursInformation LogonHours;
		Case 5: SAMRSamprUserAccountInformation Account;
		Case 6: SAMRSamprUserNameInformation Name;
		Case 7:	SAMRSamprUserANameInformation AccountName;
		Case 8: SAMRSamprUserFNameInformation FullName;
		Case 9:UserPrimaryGroupInformation PrimaryGroup;
		Case 10: SAMRSamprUserHomeInformation Home;
		Case 11: SAMRSamprUserScriptInformation Script;
		Case 12: SAMRSamprUserProfileInformation Profile;
		Case 13: SAMRSamprUserAdminCommentInformation AdminComment;
		Case 14: SAMRSamprUserWorkstationsInformation WorkStations;
		Case 16:SAMRUserControlInformation Control;
		Case 17:SAMRUserExpiresInformation Expires;
		Case 18: SAMRSamprUserInternal1Information Internal1;
		Case 20: SAMRSamprUserParametersInformation Parameters;
		Case 21: SAMRSamprUserAllInformation All;
		Case 23:SAMRSamprUserInternal4Information Internal4;
		Case 24: SAMRSamprUserInternal5Information Internal5;
		Case 25: SAMRSamprUserInternal4InformationNew Internal4InformationNew;
		Case 26:SAMRSamprUserInternal5InformationNew UserInternal5InformationNew;
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

Struct SAMRSamprUserInfoBufferPtr = FormatString("%s",SAMRSamprUserInfoBuffer.toString)
{
	NdrPtr SAMRSamprUserInfoBufferPtr;
	Switch {
		Case SAMRSamprUserInfoBufferPtr.ReferentID != 0:
			SAMRSamprUserInfoBuffer SAMRSamprUserInfoBuffer;
	}
}

//
//	_SAM_VALIDATE_AUTHENTICATION_INPUT_ARG
//
Struct SAMRSamValidateAuthenticationInputArg
{
	SAMRSamValidatePersistedFields InputPersistedFields;
	BOOLEAN PasswordMatched;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch 
	{ 
		Case Property.pPasswordHistory > 0: 
			struct SAMRValidatePasswordHashArray
			{
				NdrConformant PassWordsConf;
				Struct
				{
					[Property.PasswordsCount=0,MaxLoopCount=PassWordsConf.MaxCount]
					while[Property.PasswordsCount<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCount=Property.PasswordsCount+1]
						SAMRSamValidatePasswordHash PasswordHistorys;
					}
					[Property.PasswordsCountRef=0,MaxLoopCount=PassWordsConf.MaxCount]
					While[Property.PasswordsCountRef<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCountRef=Property.PasswordsCountRef+1]
						SAMRSamValidatePasswordHashRef PasswordHistorysRef;
					}
				}
			}
	}
}

//
//	_SAM_VALIDATE_INPUT_ARG
//
Struct SAMRSamValidateInputArg
{
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	NdrEnum PasswordPolicyValidationType = SAMRPasswordPolicyValidationTypeTable( this.value );
	Align8 Pad2;
	Switch( Property.NdrEnumValue )
	{
		Case 1:SAMRSamValidateAuthenticationInputArg ValidateAuthenticationInput;
		Case 2:SAMRSamValidatePasswordChangeInputArg ValidatePasswordChangeInput;
		Case 3:SAMRSamValidatePasswordResetInputArg ValidatePasswordResetInput;
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

//
//	_SAM_VALIDATE_OUTPUT_ARG
//
Struct SAMRSamValidateOutputArg
{
	Switch
	{
		case Property.MSRPCNdr64: Align8 Pad1;
	}
	NdrEnum Value = SAMRPasswordPolicyValidationTypeTable(this.value);
	Align8 Pad2;
	Switch( Property.NdrEnumValue )
	{
		Case 1:
			SAMRSamValidateStandardOutputArg ValidateAuthenticationOutput;
		Case 2:
			SAMRSamValidateStandardOutputArg ValidatePasswordChangeOutput;
		Case 3:
			SAMRSamValidateStandardOutputArg ValidatePasswordResetOutput;
		Default:
			ReportParserError( ParserErrorProtocolClassWindows, "SAMR", "Unknown Union Switch Value" ) Unknown;
	}
}

Struct SAMRSamValidateOutputArgPtr
{
	NdrPtr SamValidateOutputArgPtr;
	Switch {
		Case SamValidateOutputArgPtr.ReferentID != 0:
			SAMRSamValidateOutputArg SamValidateOutputArg;
	}
}

//
//	_SAM_VALIDATE_PASSWORD_CHANGE_INPUT_ARG
//
Struct SAMRSamValidatePasswordChangeInputArg = FormatString( "ClearPassword: %s,  UserAccountName: %s", ClearPassword, UserAccountName )
{
	SAMRSamValidatePersistedFields InputPersistedFields;
	[Post.SamprClearPasswordHeaderPointer = ClearPasswordHeader.BufferPtr.ReferentID ? ClearPasswordHeader.BufferPtr.ReferentID : 0]			
	NdrUnicodeStringHeader ClearPasswordHeader;
	[Post.SamprUserAccountNameHeaderPointer = UserAccountNameHeader.BufferPtr.ReferentID ? UserAccountNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader UserAccountNameHeader;
	[Post.Property.HashedPasswordPointer=HashedPassword.HashArrayPtr.ReferentID]
	SAMRSamValidatePasswordHash HashedPassword;
	BOOLEAN PasswordMatch;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad1;
	}
	Switch 
	{ 
		Case Property.pPasswordHistory > 0: 
			struct SAMRValidatePasswordHashArray
			{
				NdrConformant PassWordsConf;
				Struct
				{
					[Property.PasswordsCount=0,MaxLoopCount=PassWordsConf.MaxCount]
					while[Property.PasswordsCount<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCount=Property.PasswordsCount+1]
						SAMRSamValidatePasswordHash PasswordHistorys;
					}
					[Property.PasswordsCountRef=0,MaxLoopCount=PassWordsConf.MaxCount]
					While[Property.PasswordsCountRef<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCountRef=Property.PasswordsCountRef+1]
						SAMRSamValidatePasswordHashRef PasswordHistorysRef;
					}
				}
			}
	}
	Switch {
		Case SamprClearPasswordHeaderPointer > 0: NdrWideString ClearPassword;
	}
	Switch {
		Case SamprUserAccountNameHeaderPointer > 0: NdrWideString UserAccountName;
	}
	Switch
	{
		Case Property.HashedPasswordPointer > 0:
			SAMRSamValidatePasswordHashRef PasswordHistorysRef;
	}
}

//
//	_SAM_VALIDATE_PASSWORD_HASH
//
Struct SAMRSamValidatePasswordHash
{
	NdrAlign pad;
	UINT32 Length;
	[Property.HashArrayPtr$[Property.PasswordsCount]=this.ReferentID]
	NdrPtr  HashArrayPtr;
}
Struct SAMRSamValidatePasswordHashRef
{
	Switch
	{
		Case Property.HashArrayPtr$[Property.PasswordsCountRef]> 0:
			Struct
			{
				NdrConformant Size;
				BLOB( Size.MaxCount) Hash;
			}
	}
	
}


//
//	_SAM_VALIDATE_PASSWORD_RESET_INPUT_ARG
//Alignment:Align8
//
Struct SAMRSamValidatePasswordResetInputArg = FormatString("PasswordMustChangeAtNextLogon: %s, ClearLockout: %s",PasswordMustChangeAtNextLogon,ClearLockout)
{
	SAMRSamValidatePersistedFields InputPersistedFields;
	[Post.SamprClearPasswordHeaderPointer = ClearPasswordHeader.BufferPtr.ReferentID ? ClearPasswordHeader.BufferPtr.ReferentID : 0]			
	NdrUnicodeStringHeader ClearPasswordHeader;
	[Post.SamprUserAccountNameHeaderPointer = UserAccountNameHeader.BufferPtr.ReferentID ? UserAccountNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader UserAccountNameHeader;
	[Post.Property.HashedPasswordPointer=HashedPassword.HashArrayPtr.ReferentID]
	SAMRSamValidatePasswordHash HashedPassword;
	BOOLEAN PasswordMustChangeAtNextLogon;
	BOOLEAN ClearLockout;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad1;
	}
	Switch 
	{ 
		Case Property.pPasswordHistory > 0: 
			struct SAMRValidatePasswordHashArray
			{
				NdrConformant PassWordsConf;
				Struct
				{
					[Property.PasswordsCount=0,MaxLoopCount=PassWordsConf.MaxCount]
					while[Property.PasswordsCount<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCount=Property.PasswordsCount+1]
						SAMRSamValidatePasswordHash PasswordHistorys;
					}
					[Property.PasswordsCountRef=0,MaxLoopCount=PassWordsConf.MaxCount]
					While[Property.PasswordsCountRef<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCountRef=Property.PasswordsCountRef+1]
						SAMRSamValidatePasswordHashRef PasswordHistorysRef;
					}
				}
			}
	}

	Switch {
		Case SamprClearPasswordHeaderPointer > 0: NdrWideString ClearPassword;
	}

	Switch {
		Case SamprUserAccountNameHeaderPointer > 0: NdrWideString UserAccountName;
	}
	Switch
	{
		Case Property.HashedPasswordPointer > 0:
			SAMRSamValidatePasswordHashRef PasswordHistorysRef;
	}
}

//
//	_SAM_VALIDATE_PERSISTED_FIELDS
// Alignment: 8
//
Struct SAMRSamValidatePersistedFields
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct {
			UINT32 PresentFields = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
			{
				UINT32 SAMValidatePasswordLastSet:1 = FormatString("      (%s) %s", this.ToBitString,this?"The PasswordLastSet member has changed":"The PasswordLastSet member has NOT changed");
				UINT32 SAMValidateBadPasswordTime:1 = FormatString("      (%s) %s", this.ToBitString,this?"The BadPasswordTime member has changed":"The BadPasswordTime member has NOT changed");
				UINT32 SAMValidateLockoutTime:1 = FormatString("          (%s) %s", this.ToBitString,this?"The LockOutTime member has changed":"The LockOutTime member has NOT changed");
				UINT32 SAMValidateBadPasswordCount:1 = FormatString("     (%s) %s", this.ToBitString,this?"The BadPasswordCount member has changed":"The BadPasswordCount member has NOT changed");
				UINT32 SAMValidatePasswordHistoryLength:1 = FormatString("(%s) %s", this.ToBitString,this?"The PasswordHistoryLength member has changed":"he PasswordHistoryLength member has NOT changed");
				UINT32 SAMValidatePasswordHistory:1 = FormatString("      (%s) %s", this.ToBitString,this?"The PasswordHistory member has changed":"The PasswordHistory member has NOT changed");
				UINT32 Reserved:26 = FormatString("                        (%s)", this.ToBitString);
			}
		}
		Default:
		Struct {
			UINT32 PresentFields = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
			{
				UINT32 Reserved:26 = FormatString("                        (%s)", this.ToBitString);
				UINT32 SAMValidatePasswordHistory:1 = FormatString("      (%s) %s", this.ToBitString,this?"The PasswordHistory member has changed":"The PasswordHistory member has NOT changed");
				UINT32 SAMValidatePasswordHistoryLength:1 = FormatString("(%s) %s", this.ToBitString,this?"The PasswordHistoryLength member has changed":"he PasswordHistoryLength member has NOT changed");
				UINT32 SAMValidateBadPasswordCount:1 = FormatString("     (%s) %s", this.ToBitString,this?"The BadPasswordCount member has changed":"The BadPasswordCount member has NOT changed");
				UINT32 SAMValidateLockoutTime:1 = FormatString("          (%s) %s", this.ToBitString,this?"The LockOutTime member has changed":"The LockOutTime member has NOT changed");
				UINT32 SAMValidateBadPasswordTime:1 = FormatString("      (%s) %s", this.ToBitString,this?"The BadPasswordTime member has changed":"The BadPasswordTime member has NOT changed");
				UINT32 SAMValidatePasswordLastSet:1 = FormatString("      (%s) %s", this.ToBitString,this?"The PasswordLastSet member has changed":"The PasswordLastSet member has NOT changed");
			}
		}
	}
	Align8 Pad;
	INT64 PasswordLastSet = (this!= 0)? FormatString( "%T{MM/dd/yyyy}, %t{HH':'mm':'ss}.%t{ffffff tt}", this, this, this ) : "No Time Specified (0)";
	INT64 BadPasswordTime = (this!= 0)? FormatString( "%T{MM/dd/yyyy}, %t{HH':'mm':'ss}.%t{ffffff tt}", this, this, this ) : "No Time Specified (0)";
	INT64 LockoutTime = (this!= 0)? FormatString( "%T{MM/dd/yyyy}, %t{HH':'mm':'ss}.%t{ffffff tt}", this, this, this ) : "No Time Specified (0)";
	UINT32 BadPasswordCount;
	UINT32 PasswordHistoryLength;
	[Property.pPasswordHistory = PointerToPasswordHistory.ReferentID]
	NdrPtr PointerToPasswordHistory;
}


Table SAMRSamValidatePersistedFieldsPresentFieldsTable( Value )
{
	Switch( Value )
	{
		Case 0x00000001: "SAM_VALIDATE_PASSWORD_LAST_SET - PasswordLastSet";
		Case 0x00000002: "SAM_VALIDATE_BAD_PASSWORD_TIME - BadPasswordTime";
		Case 0x00000004: "SAM_VALIDATE_LOCKOUT_TIME - LockoutTime";
		Case 0x00000008: "SAM_VALIDATE_BAD_PASSWORD_COUNT - BadPasswordCount";
		Case 0x00000010: "SAM_VALIDATE_PASSWORD_HISTORY_LENGTH - PasswordHistoryLength";
		Case 0x00000020: "SAM_VALIDATE_PASSWORD_HISTORY - PasswordHistory";
		Default: "Unknown";
	}
}

//
//	_SAM_VALIDATE_STANDARD_OUTPUT_ARG
//Alignment:NdrAlign
//
Struct SAMRSamValidateStandardOutputArg
{
	SAMRSamValidatePersistedFields ChangedPersistedFields;
	SAMRSamValidateValidationStatus ValidationStatus;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch 
	{ 
		Case Property.pPasswordHistory > 0: 
			struct SAMRValidatePasswordHashArray
			{
				NdrConformant PassWordsConf;
				Struct
				{
					[Property.PasswordsCount=0,MaxLoopCount=PassWordsConf.MaxCount]
					while[Property.PasswordsCount<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCount=Property.PasswordsCount+1]
						SAMRSamValidatePasswordHash PasswordHistorys;
					}
					[Property.PasswordsCountRef=0,MaxLoopCount=PassWordsConf.MaxCount]
					While[Property.PasswordsCountRef<PassWordsConf.MaxCount]
					{
						[Property.PasswordsCountRef=Property.PasswordsCountRef+1]
						SAMRSamValidatePasswordHashRef PasswordHistorysRef;
					}
				}
			}
	}
}

//
//	_SAM_VALIDATE_VALIDATION_STATUS
//
Struct SAMRSamValidateValidationStatus
{
	NdrEnum Value = SAMRSamValidateValidationStatusTable(this);
}

Table SAMRSamValidateValidationStatusTable( Value )
{
	Switch( Value )
	{
		Case 0: "SamValidateSuccess - SamValidateSuccess constant.";
		Case 1: "SamValidatePasswordMustChange - SamValidatePasswordMustChange constant.";
		Case 2: "SamValidateAccountLockedOut - SamValidateAccountLockedOut constant.";
		Case 3: "SamValidatePasswordExpired - SamValidatePasswordExpired constant.";
		Case 4: "SamValidatePasswordIncorrect - SamValidatePasswordIncorrect constant.";
		Case 5: "SamValidatePasswordIsInHistory - SamValidatePasswordIsInHistory constant.";
		Case 6: "SamValidatePasswordTooShort - SamValidatePasswordTooShort constant.";
		Case 7: "SamValidatePasswordTooLong - SamValidatePasswordTooLong constant.";
		Case 8: "SamValidatePasswordNotComplexEnough - SamValidatePasswordNotComplexEnough constant.";
		Case 9: "SamValidatePasswordTooRecent - SamValidatePasswordTooRecent constant.";
		Case 10: "SamValidatePasswordFilterError - SamValidatePasswordFilterError constant.";
		Default:"Unknown";
	}
}

Table SAMRMethodNameTable( Opnum )
{
	Switch( Opnum )
	{
		Case 0: "SamrConnect";
		Case 1: "SamrCloseHandle";
		Case 2: "SamrSetSecurityObject";
		Case 3: "SamrQuerySecurityObject";
		Case 4: "Opnum4NotUsedOnWire";
		Case 5: "SamrLookupDomainInSamServer";
		Case 6: "SamrEnumerateDomainsInSamServer";
		Case 7: "SamrOpenDomain";
		Case 8: "SamrQueryInformationDomain";
		Case 9: "SamrSetInformationDomain";
		Case 10: "SamrCreateGroupInDomain";
		Case 11: "SamrEnumerateGroupsInDomain";
		Case 12: "SamrCreateUserInDomain";
		Case 13: "SamrEnumerateUsersInDomain";
		Case 14: "SamrCreateAliasInDomain";
		Case 15: "SamrEnumerateAliasesInDomain";
		Case 16: "SamrGetAliasMembership";
		Case 17: "SamrLookupNamesInDomain";
		Case 18: "SamrLookupIdsInDomain";
		Case 19: "SamrOpenGroup";
		Case 20: "SamrQueryInformationGroup";
		Case 21: "SamrSetInformationGroup";
		Case 22: "SamrAddMemberToGroup";
		Case 23: "SamrDeleteGroup";
		Case 24: "SamrRemoveMemberFromGroup";
		Case 25: "SamrGetMembersInGroup";
		Case 26: "SamrSetMemberAttributesOfGroup";
		Case 27: "SamrOpenAlias";
		Case 28: "SamrQueryInformationAlias";
		Case 29: "SamrSetInformationAlias";
		Case 30: "SamrDeleteAlias";
		Case 31: "SamrAddMemberToAlias";
		Case 32: "SamrRemoveMemberFromAlias";
		Case 33: "SamrGetMembersInAlias";
		Case 34: "SamrOpenUser";
		Case 35: "SamrDeleteUser";
		Case 36: "SamrQueryInformationUser";
		Case 37: "SamrSetInformationUser";
		Case 38: "SamrChangePasswordUser";
		Case 39: "SamrGetGroupsForUser";
		Case 40: "SamrQueryDisplayInformation";
		Case 41: "SamrGetDisplayEnumerationIndex";
		Case 42: "Opnum42NotUsedOnWire";
		Case 43: "Opnum43NotUsedOnWire";
		Case 44: "SamrGetUserDomainPasswordInformation";
		Case 45: "SamrRemoveMemberFromForeignDomain";
		Case 46: "SamrQueryInformationDomain2";
		Case 47: "SamrQueryInformationUser2";
		Case 48: "SamrQueryDisplayInformation2";
		Case 49: "SamrGetDisplayEnumerationIndex2";
		Case 50: "SamrCreateUser2InDomain";
		Case 51: "SamrQueryDisplayInformation3";
		Case 52: "SamrAddMultipleMembersToAlias";
		Case 53: "SamrRemoveMultipleMembersFromAlias";
		Case 54: "SamrOemChangePasswordUser2";
		Case 55: "SamrUnicodeChangePasswordUser2";
		Case 56: "SamrGetDomainPasswordInformation";
		Case 57: "SamrConnect2";
		Case 58: "SamrSetInformationUser2";
		Case 59: "Opnum59NotUsedOnWire";
		Case 60: "Opnum60NotUsedOnWire";
		Case 61: "Opnum61NotUsedOnWire";
		Case 62: "SamrConnect4";
		Case 63: "Opnum63NotUsedOnWire";
		Case 64: "SamrConnect5";
		Case 65: "SamrRidToSid";
		Case 66: "SamrSetDSRMPassword";
		Case 67: "SamrValidatePassword";
		Case 68: "Opnum68NotUsedOnWire";
		Case 69: "Opnum69NotUsedOnWire";
		Default: "Unknown";
	}
}

Struct SAMRServerSpecificRights = SAMRServerSpecificRightsTable(UINT32(FrameData,FrameOffset))
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 SamServerConnect:1 = FormatString("         (%s) %s", this.ToBitString, this?"Allow connecting to the SAM server for purposes of administration":"Do NOT allow connecting to the SAM server for purposes of administration");
				UINT16 SamServerShutDown:1 = FormatString("        (%s) %s", this.ToBitString, this?"Allow shutting down the SAM server":"Do NOT allow shutting down the SAM server");
				UINT16 SamServerInitialize:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow forcing the SAM server to initialize itself":"Do NOT allow forcing the SAM server to initialize itself");
				UINT16 SamServerCreateDomain:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow creating a new domain object in the SAM server":"Do NOT allow creating a new domain object in the SAM server");
				UINT16 SamServerEnumerateDomains:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow obtaining a list of the domains served by the server":"Do NOT allow obtaining a list of the domains served by the server");
				UINT16 SamServerLookupDomain:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow translating the name of a domain into its corresponding SID value":"Do NOT allow translating the name of a domain into its corresponding SID value");
				UINT16 Reserved:10 = FormatString("                 (%s)", this.ToBitString); 
			};
			MSRPCAccessRights AccessRights;
		}
		Default:
		Struct
		{
			MSRPCAccessRights AccessRights;
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 Reserved:10 = FormatString("                 (%s)", this.ToBitString); 
				UINT16 SamServerLookupDomain:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow translating the name of a domain into its corresponding SID value":"Do NOT allow translating the name of a domain into its corresponding SID value");
				UINT16 SamServerEnumerateDomains:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow obtaining a list of the domains served by the server":"Do NOT allow obtaining a list of the domains served by the server");
				UINT16 SamServerCreateDomain:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow creating a new domain object in the SAM server":"Do NOT allow creating a new domain object in the SAM server");
				UINT16 SamServerInitialize:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow forcing the SAM server to initialize itself":"Do NOT allow forcing the SAM server to initialize itself");
				UINT16 SamServerShutDown:1 = FormatString("        (%s) %s", this.ToBitString, this?"Allow shutting down the SAM server":"Do NOT allow shutting down the SAM server");
				UINT16 SamServerConnect:1 = FormatString("         (%s) %s", this.ToBitString, this?"Allow connecting to the SAM server for purposes of administration":"Do NOT allow connecting to the SAM server for purposes of administration");
			}
		}
	}
}

//
//	Sampr_ENUMERATION_BUFFER
//	Alignment: NDR
//
Struct SAMRPSamprEnumerationBuffer = FormatString("Entries: %u",EntriesRead)
{
	[SAMRSamprRidEnumerationArrayLoop = 0,RpcUnicodeLoop = 0]
	UINT32 EntriesRead;
	NdrPtr ArrayPointer;
	Switch
	{
		Case ArrayPointer.ReferentID > 0:
		Struct Buffer
		{
			NdrConformant EntriesReadConformant;
			SAMRSamprRidEnumeration RelativeIdentifiers[ EntriesReadConformant.Maxcount ];
			While SAMRSamprRidEnumerationArrayWhileLoop[ SAMRSamprRidEnumerationArrayLoop < RpcUnicodeLoop ]
			{
				[SAMRSamprRidEnumerationArrayLoop = SAMRSamprRidEnumerationArrayLoop + 1]
				Switch {
					Case NdrUnicodeStringHeaderArray$[ SAMRSamprRidEnumerationArrayLoop - 1 ] > 0: [SamprNameString = Name.toString] NdrWideString Name;
				}
			}
		}
	}
}

Struct SAMRPSamprEnumerationBufferPtr
{
	NdrPtr SamprEnumerationBufferPtr;
	Switch 
	{
		Case SamprEnumerationBufferPtr.ReferentID != 0:
			SAMRPSamprEnumerationBuffer SamprEnumerationBuffer;
	}
}

Table SAMRDomainDisplayInformationClassTypeTable( Value, Description )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "%u - DomainDisplayUser %s", Value, Description ? "- The type of domain display information is SAMRSamprDomainDisplayUserBuffer" : "" );
		Case 0x0002: FormatString( "%u - DomainDisplayMachine %s", Value, Description ? "- The type of domain display information is SAMRSamprDomainDisplayMachineBuffer" : "" );
		Case 0x0003: FormatString( "%u - DomainDisplayGroup %s", Value, Description ? "- The type of domain display information is SAMRSamprDomainDisplayGroupBuffer" : "" );
		Case 0x0004: FormatString( "%u - DomainDisplayOemUser %s", Value, Description ? "- The type of domain display information is SAMRSamprDomainDisplayOEMUserBuffer" : "" );
		Case 0x0005: FormatString( "%u - DomainDisplayOemGroup %s", Value, Description ? "- The type of domain display information is SAMRSamprDomainDisplayOEMGroupBuffer" : "" );
		Default    : FormatString( "%u - No Description Available", Value );
	}
}

Struct SAMRGroupSpecificRights = SAMRGroupSpecificRightsTable(UINT32(FrameData,FrameOffset))
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 GroupReadInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the information of a group account":"Do NOT allow reading the information of a group account");
				UINT16 GroupWriteAccount:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the Name, Attributes, or AdminComment of a group account":"Do NOT allow modifying the Name, Attributes, or AdminComment of a group account");
				UINT16 GroupAddMember:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow adding members to an existing group":"Do NOT allow adding members to an existing group");
				UINT16 GroupRemoveMember:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow removing the members from an existing group":"Do NOT allow removing the members from an existing group");
				UINT16 GroupListMembers:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow obtaining a list of the members of a group":"Do NOT allow obtaining a list of the members of a group");
				UINT16 Reserved:11 = FormatString("            (%s)", this.ToBitString);
			}
			MSRPCAccessRights AccessRights;
		};
		Default:
		Struct
		{
			MSRPCAccessRights AccessRights;
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 Reserved:11 = FormatString("            (%s)", this.ToBitString);
				UINT16 GroupListMembers:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow obtaining a list of the members of a group":"Do NOT allow obtaining a list of the members of a group");
				UINT16 GroupRemoveMember:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow removing the members from an existing group":"Do NOT allow removing the members from an existing group");
				UINT16 GroupAddMember:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow adding members to an existing group":"Do NOT allow adding members to an existing group");
				UINT16 GroupWriteAccount:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the Name, Attributes, or AdminComment of a group account":"Do NOT allow modifying the Name, Attributes, or AdminComment of a group account");
				UINT16 GroupReadInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the information of a group account":"Do NOT allow reading the information of a group account");
			}
		};
	}
}

Table SAMRGroupSpecificRightsTable( Value )
{
	Switch( Value )
	{
		Case 0x00020001: FormatString( "0x%08X - GROUP_ALL_EXECUTE - The specified accesses for a GENERIC_EXECUTE request", Value );
		Case 0x0002000E: FormatString( "0x%08X - GROUP_ALL_WRITE - The specified accesses for a GENERIC_WRITE request", Value );
		Case 0x00020010: FormatString( "0x%08X - GROUP_ALL_READ - The specified accesses for a GENERIC_READ request", Value );
		Case 0x000F001F: FormatString( "0x%08X - GROUP_ALL_ACCESS - The specified accesses for a GENERIC_ALL request", Value );
		Default        : FormatString( "0x%08X", Value );
	}
}

Struct SAMRAliasSpecificRights = SAMRAliasSpecificRightsTable(UINT32(FrameData,FrameOffset))
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 AliasAddMember:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow adding a member to an existing alias":"Do NOT allow adding a member to an existing alias");
				UINT16 AliasRemoveMember:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow removing a member from an existing alias":"Do NOT allow removing a member from an existing alias");
				UINT16 AliasListMember:1 = FormatString("     (%s) %s", this.ToBitString, this?"Allow obtaining a list of the members of an alias":"Do NOT allow obtaining a list of the members of an alias");
				UINT16 AliasReadInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the information of an alias account":"Do NOT allow reading the information of an alias account");
				UINT16 AliasWriteAccount:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the Name or AdminComment of an alias account":"Do NOT allow modifying the Name or AdminComment of an alias account");
				UINT16 Reserved:11 = FormatString("            (%s)", this.ToBitString);
			}
			MSRPCAccessRights AccessRights;
		};
		Default:
		Struct
		{
			MSRPCAccessRights AccessRights;

			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 Reserved:11 = FormatString("            (%s)", this.ToBitString);
				UINT16 AliasWriteAccount:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the Name or AdminComment of an alias account":"Do NOT allow modifying the Name or AdminComment of an alias account");
				UINT16 AliasReadInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the information of an alias account":"Do NOT allow reading the information of an alias account");
				UINT16 AliasListMember:1 = FormatString("     (%s) %s", this.ToBitString, this?"Allow obtaining a list of the members of an alias":"Do NOT allow obtaining a list of the members of an alias");
				UINT16 AliasRemoveMember:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow removing a member from an existing alias":"Do NOT allow removing a member from an existing alias");
				UINT16 AliasAddMember:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow adding a member to an existing alias":"Do NOT allow adding a member to an existing alias");
			}
		};
	}
}

Table SAMRAliasSpecificRightsTable( Value )
{
	Switch( Value )
	{
		Case 0x00020008: FormatString( "0x%08X - ALIAS_ALL_EXECUTE - The specified accesses for a GENERIC_EXECUTE request", Value );
		Case 0x00020013: FormatString( "0x%08X - ALIAS_ALL_WRITE - The specified accesses for a GENERIC_WRITE request", Value );
		Case 0x00020004: FormatString( "0x%08X - ALIAS_ALL_READ - The specified accesses for a GENERIC_READ request", Value );
		Case 0x000F001F: FormatString( "0x%08X - ALIAS_ALL_ACCESS - The specified accesses for a GENERIC_ALL request", Value );
		Default        : FormatString( "0x%08X", Value );
	}
}

Struct SAMRUserSpecificRights = SAMRUserSpecificRightsTable(UINT32(FrameData,FrameOffset))
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 UserReadGeneral:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow reading the following user account information: UserId, UserName, FullName, PrimaryGroupId, AdminComment, and UserComment":"Do NOT allow reading the following user account information: UserId, UserName, FullName, PrimaryGroupId, AdminComment, and UserComment");
				UINT16 UserReadPreferences:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow reading the following user account information: Parameters, CountryCode, and CodePage":"Do NOT allow reading the following user account information: Parameters, CountryCode, and CodePage");
				UINT16 UserWritePreferences:1 = FormatString("     (%s) %s", this.ToBitString, this?"Allow modifying the following user account information: Parameters, CountryCode, CodePage, and UserComment":"Do NOT allow modifying the following user account information: Parameters, CountryCode, CodePage, and UserComment");
				UINT16 UserReadLogon:1 = FormatString("            (%s) %s", this.ToBitString, this?"Allow reading the following user account information: HomeDirectory, ScriptPath, WorkStations, LastLogon, LastLogoff, LogonHours, BadPasswordCount, and LogonCount":"Do NOT allow reading the following user account information: HomeDirectory, ScriptPath, WorkStations, LastLogon, LastLogoff, LogonHours, BadPasswordCount, and LogonCount");
				UINT16 UserReadAccount:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow reading the following user account information: PasswordLastSet, UserAccountControl, AccountExpires":"Do NOT allow reading the following user account information: PasswordLastSet, UserAccountControl, AccountExpires");
				UINT16 UserWriteAccount:1 = FormatString("         (%s) %s", this.ToBitString, this?"Allow modifying the following user account information: UserName, FullName, PrimaryGroupId, HomeDirectory, ScriptPath, AdminComment, WorkStations, LogonHours, Password, UserAccountControl, and AccountExpires":"Do NOT allow modifying the following user account information: UserName, FullName, PrimaryGroupId, HomeDirectory, ScriptPath, AdminComment, WorkStations, LogonHours, Password, UserAccountControl, and AccountExpires");
				UINT16 UserChangePassword:1 = FormatString("       (%s) %s", this.ToBitString, this?"Allow changing the password after demonstrating knowledge of the current password":"Do NOT allow changing the password after demonstrating knowledge of the current password");
				UINT16 UserForcePasswordChange:1 = FormatString("  (%s) %s", this.ToBitString, this?"Allow changing the password without demonstrating knowledge of the current password":"Do NOT allow changing the password without demonstrating knowledge of the current password");
				UINT16 UserListGroups:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow obtaining a list of groups of which the user is a member":"Do NOT allow obtaining a list of groups of which the user is a member");
				UINT16 UserReadGroupInformation:1 = FormatString(" (%s) %s", this.ToBitString, this?"Allow reading the group membership attributes":"Do NOT allow reading the group membership attributes");
				UINT16 UserWriteGroupInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow modifying the group membership attributes":"Do NOT allow modifying the group membership attributes");
				UINT16 Reserved:5 = FormatString("                 (%s)", this.ToBitString); 
			}
			MSRPCAccessRights AccessRights;
		};
		Default:
		Struct
		{
			MSRPCAccessRights AccessRights;
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset) )
			{
				UINT16 Reserved:5 = FormatString("                 (%s)", this.ToBitString); 
				UINT16 UserWriteGroupInformation:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow modifying the group membership attributes":"Do NOT allow modifying the group membership attributes");
				UINT16 UserReadGroupInformation:1 = FormatString(" (%s) %s", this.ToBitString, this?"Allow reading the group membership attributes":"Do NOT allow reading the group membership attributes");
				UINT16 UserListGroups:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow obtaining a list of groups of which the user is a member":"Do NOT allow obtaining a list of groups of which the user is a member");
				UINT16 UserForcePasswordChange:1 = FormatString("  (%s) %s", this.ToBitString, this?"Allow changing the password without demonstrating knowledge of the current password":"Do NOT allow changing the password without demonstrating knowledge of the current password");
				UINT16 UserChangePassword:1 = FormatString("       (%s) %s", this.ToBitString, this?"Allow changing the password after demonstrating knowledge of the current password":"Do NOT allow changing the password after demonstrating knowledge of the current password");
				UINT16 UserWriteAccount:1 = FormatString("         (%s) %s", this.ToBitString, this?"Allow modifying the following user account information: UserName, FullName, PrimaryGroupId, HomeDirectory, ScriptPath, AdminComment, WorkStations, LogonHours, Password, UserAccountControl, and AccountExpires":"Do NOT allow modifying the following user account information: UserName, FullName, PrimaryGroupId, HomeDirectory, ScriptPath, AdminComment, WorkStations, LogonHours, Password, UserAccountControl, and AccountExpires");
				UINT16 UserReadAccount:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow reading the following user account information: PasswordLastSet, UserAccountControl, AccountExpires":"Do NOT allow reading the following user account information: PasswordLastSet, UserAccountControl, AccountExpires");
				UINT16 UserReadLogon:1 = FormatString("            (%s) %s", this.ToBitString, this?"Allow reading the following user account information: HomeDirectory, ScriptPath, WorkStations, LastLogon, LastLogoff, LogonHours, BadPasswordCount, and LogonCount":"Do NOT allow reading the following user account information: HomeDirectory, ScriptPath, WorkStations, LastLogon, LastLogoff, LogonHours, BadPasswordCount, and LogonCount");
				UINT16 UserWritePreferences:1 = FormatString("     (%s) %s", this.ToBitString, this?"Allow modifying the following user account information: Parameters, CountryCode, CodePage, and UserComment":"Do NOT allow modifying the following user account information: Parameters, CountryCode, CodePage, and UserComment");
				UINT16 UserReadPreferences:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow reading the following user account information: Parameters, CountryCode, and CodePage":"Do NOT allow reading the following user account information: Parameters, CountryCode, and CodePage");
				UINT16 UserReadGeneral:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow reading the following user account information: UserId, UserName, FullName, PrimaryGroupId, AdminComment, and UserComment":"Do NOT allow reading the following user account information: UserId, UserName, FullName, PrimaryGroupId, AdminComment, and UserComment");
			}
		};
	}
}

Table SAMRUserSpecificRightsTable( Value )
{
	Switch( Value )
	{
		Case 0x00020041: FormatString( "0x%08X - USER_ALL_EXECUTE - The specified accesses for a GENERIC_EXECUTE request", Value );
		Case 0x00020044: FormatString( "0x%08X - USER_ALL_WRITE - The specified accesses for a GENERIC_WRITE request", Value );
		Case 0x0002031A: FormatString( "0x%08X - USER_ALL_READ - The specified accesses for a GENERIC_READ request", Value );
		Case 0x000F07FF: FormatString( "0x%08X - USER_ALL_ACCESS - The specified accesses for a GENERIC_ALL request", Value );
		Default        : FormatString( "0x%08X", Value );
	}
}

Struct SAMRUserAccountControl = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT32 UserAccountControl = FormatString( "0x%08X", this )
			{
				UINT32 UserScript:1 = FormatString("                            (%s) %s", this.ToBitString,this?"The logon script is executed":"The logon script is not executed");
				UINT32 UserAccountDisable:1 = FormatString("                    (%s) %s", this.ToBitString,this?"The user account is disabled":"The user account is not disabled");
				UINT32 Reserved1:1 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserHomedirRequired:1 = FormatString("                   (%s) %s", this.ToBitString,this?"The home directory is required":"The home directory is not required");
				UINT32 UserLockout:1 = FormatString("                           (%s) %s", this.ToBitString,this?"The account is currently locked out":"The account is not currently locked out");
				UINT32 UserPasswdNotreqd:1 = FormatString("                     (%s) %s", this.ToBitString,this?"No password is required":"Password is required");
				UINT32 UserPasswdCantChange:1 = FormatString("                  (%s) %s", this.ToBitString,this?"The user cannot change the password":"The user can change the password");
				UINT32 UserEncryptedTextPasswordAllowed:1 = FormatString("      (%s) %s", this.ToBitString,this?"The user can send an encrypted password":"The user can not send an encrypted password");
				UINT32 UserTempDuplicateAccount:1 = FormatString("              (%s) %s", this.ToBitString,this?"This account provides user access to this domain,":"This account don't provide user access to this domain,");
				UINT32 UserNormalAccount:1 = FormatString("                     (%s) %s", this.ToBitString,this?"This is a default account type that represents a typical user":"This is not a default account type that represents a typical user");
				UINT32 Reserved2:1 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserInterdomainTrustAccount:1 = FormatString("           (%s) %s", this.ToBitString,this?"This is a permit to trust account for a system domain that trusts other domains":"This is not a permit to trust account for a system domain that trusts other domains");
				UINT32 UserWorkstationTrustAccount:1 = FormatString("           (%s) %s", this.ToBitString,this?"This is a computer account for a computer that is a member of this domain":"This is not a computer account for a computer that is a member of this domain");
				UINT32 UserServerTrustAccount:1 = FormatString("                (%s) %s", this.ToBitString,this?"This is a computer account for a system backup domain controller that is a member of this domain":"This is not a computer account for a system backup domain controller that is a member of this domain");
				UINT32 Reserved3:2 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserDontExpirePasswd:1 = FormatString("                  (%s) %s", this.ToBitString,this?"The password for this account will never expire":"The password for this account will expire");
				UINT32 UserMnsLogonAccount:1 = FormatString("                   (%s) %s", this.ToBitString,this?"This is an MNS logon account":"This is not an MNS logon account");
				UINT32 UserSmartcardRequired:1 = FormatString("                 (%s) %s", this.ToBitString,this?"The user must log on using a smart card":"The user must not log on using a smart card");
				UINT32 UserTrustedForDelegation:1 = FormatString("              (%s) %s", this.ToBitString,this?"The service account (user or computer account), under which a service runs, is trusted for Kerberos delegation":"The service account (user or computer account), under which a service runs, is not trusted for Kerberos delegation");
				UINT32 UserNotDelegated:1 = FormatString("                      (%s) %s", this.ToBitString,this?"The security context of the user will not be delegated to a service even if the service account is set as trusted for Kerberos delegation":"The security context of the user will be delegated to a service even if the service account is set as trusted for Kerberos delegation");
				UINT32 UserUseDesKeyOnly:1 = FormatString("                     (%s) %s", this.ToBitString,this?"Restrict this principal to use only Data Encryption Standard (DES) encryption types for keys":"Don't restrict this principal to use only Data Encryption Standard (DES) encryption types for keys");
				UINT32 UserDontRequirePreauth:1 = FormatString("                (%s) %s", this.ToBitString,this?"This account does not require Kerberos pre-authentication for logon":"This account require Kerberos pre-authentication for logon");
				UINT32 UserPasswordExpired:1 = FormatString("                   (%s) %s", this.ToBitString,this?"The user password has expired":"The user password has not expired");
				UINT32 UserTrustedToAuthenticateForDelegation:1 = FormatString("(%s) %s", this.ToBitString,this?"The account is enabled for delegation":"The account is disabled for delegation");
				UINT32 UserNoAuthDataRequired:1 = FormatString("                (%s) %s", this.ToBitString,this?"The PAC MUST NOT be included when the KDC is issuing a service ticket for this account":"The PAC MUST be included when the KDC is issuing a service ticket for this account");
				UINT32 Reserved4:6 = FormatString("                             (%s)", this.ToBitString);
			}
		}
		Default:
		Struct
		{
			UINT32 UserAccountControl = FormatString( "0x%08X", this )
			{
				UINT32 Reserved4:6 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserNoAuthDataRequired:1 = FormatString("                (%s)", this.ToBitString);
				UINT32 UserTrustedToAuthenticateForDelegation:1 = FormatString("(%s) %s", this.ToBitString,this?"The account is enabled for delegation":"The account is disabled for delegation");
				UINT32 UserPasswordExpired:1 = FormatString("                   (%s) %s", this.ToBitString,this?"The user password has expired":"The user password has not expired");
				UINT32 UserDontRequirePreauth:1 = FormatString("                (%s) %s", this.ToBitString,this?"This account does not require Kerberos pre-authentication for logon":"This account require Kerberos pre-authentication for logon");
				UINT32 UserUseDesKeyOnly:1 = FormatString("                     (%s) %s", this.ToBitString,this?"Restrict this principal to use only Data Encryption Standard (DES) encryption types for keys":"Don't restrict this principal to use only Data Encryption Standard (DES) encryption types for keys");
				UINT32 UserNotDelegated:1 = FormatString("                      (%s) %s", this.ToBitString,this?"The security context of the user will not be delegated to a service even if the service account is set as trusted for Kerberos delegation":"The security context of the user will be delegated to a service even if the service account is set as trusted for Kerberos delegation");
				UINT32 UserTrustedForDelegation:1 = FormatString("              (%s) %s", this.ToBitString,this?"The service account (user or computer account), under which a service runs, is trusted for Kerberos delegation":"The service account (user or computer account), under which a service runs, is not trusted for Kerberos delegation");
				UINT32 UserSmartcardRequired:1 = FormatString("                 (%s) %s", this.ToBitString,this?"The user must log on using a smart card":"The user must not log on using a smart card");
				UINT32 UserMnsLogonAccount:1 = FormatString("                   (%s) %s", this.ToBitString,this?"This is an MNS logon account":"This is not an MNS logon account");
				UINT32 UserDontExpirePasswd:1 = FormatString("                  (%s) %s", this.ToBitString,this?"The password for this account will never expire":"The password for this account will expire");
				UINT32 Reserved3:2 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserServerTrustAccount:1 = FormatString("                (%s) %s", this.ToBitString,this?"This is a computer account for a system backup domain controller that is a member of this domain":"This is not a computer account for a system backup domain controller that is a member of this domain");
				UINT32 UserWorkstationTrustAccount:1 = FormatString("           (%s) %s", this.ToBitString,this?"This is a computer account for a computer that is a member of this domain":"This is not a computer account for a computer that is a member of this domain");
				UINT32 UserInterdomainTrustAccount:1 = FormatString("           (%s) %s", this.ToBitString,this?"This is a permit to trust account for a system domain that trusts other domains":"This is not a permit to trust account for a system domain that trusts other domains");
				UINT32 Reserved2:1 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserNormalAccount:1 = FormatString("                     (%s) %s", this.ToBitString,this?"This is a default account type that represents a typical user":"This is not a default account type that represents a typical user");
				UINT32 UserTempDuplicateAccount:1 = FormatString("              (%s) %s", this.ToBitString,this?"This account provides user access to this domain,":"This account don't provide user access to this domain,");
				UINT32 UserEncryptedTextPasswordAllowed:1 = FormatString("      (%s) %s", this.ToBitString,this?"The user can send an encrypted password":"The user can not send an encrypted password");
				UINT32 UserPasswdCantChange:1 = FormatString("                  (%s) %s", this.ToBitString,this?"The user cannot change the password":"The user can change the password");
				UINT32 UserPasswdNotreqd:1 = FormatString("                     (%s) %s", this.ToBitString,this?"No password is required":"Password is required");
				UINT32 UserLockout:1 = FormatString("                           (%s) %s", this.ToBitString,this?"The account is currently locked out":"The account is not currently locked out");
				UINT32 UserHomedirRequired:1 = FormatString("                   (%s) %s", this.ToBitString,this?"The home directory is required":"The home directory is not required");
				UINT32 Reserved1:1 = FormatString("                             (%s)", this.ToBitString);
				UINT32 UserAccountDisable:1 = FormatString("                    (%s) %s", this.ToBitString,this?"The user account is disabled":"The user account is not disabled");
				UINT32 UserScript:1 = FormatString("                            (%s) %s", this.ToBitString,this?"The logon script is executed":"The logon script is not executed");
			}
		}
	}
}

//
//	USER_DOMAIN_PASSWORD_INFORMATION
//	Alignment: 4
//
Struct SAMRUserDomainPasswordInformation = FormatString( "MinPasswordLength: %u, PasswordProperties: %s", MinPasswordLength, PasswordProperties.toString )
{
	UINT32 MinPasswordLength;
	SAMRPasswordProperties PasswordProperties;
}

Struct SAMRPasswordProperties = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT32 PasswordProperties = FormatString( "0x%08X", this )
			{
				UINT32 DomainPasswordComplex:1 = FormatString("       (%s) %s", this.ToBitString, this?"Password must have a combination of at least two of the following types of characters: Uppercase/Lowercase/Numeric characters":"Password can be of any combination of characters");
				UINT32 DomainPasswordNoAnonChange:1 = FormatString("  (%s) %s", this.ToBitString, "Not used");
				UINT32 DomainPasswordNoClearChange:1 = FormatString(" (%s) %s", this.ToBitString, "Not used");
				UINT32 DomainLockoutAdmins:1 = FormatString("         (%s) %s", this.ToBitString, this?"Administrator account is subject to the normal lockout policy":"Administrator account is NOT subject to the normal lockout policy");
				UINT32 DomainPasswordStoreCleartext:1 = FormatString("(%s) %s", this.ToBitString, this?"The encrypted, clear-text password of every user account is stored":"The encrypted, clear-text password of every user account is NOT stored");
				UINT32 DomainRefusePasswordChange:1 = FormatString("  (%s) %s", this.ToBitString, this?"Password can NOT be changed. Only the default password is allowed":"Password can be changed");		
				UINT32 Reserved:26 = FormatString("                    (%s)", this.ToBitString);
			}
		}
		Default:
		Struct
		{
			UINT32 PasswordProperties = FormatString( "0x%08X", this )
			{
				UINT32 Reserved:26 = FormatString("                    (%s)", this.ToBitString);
				UINT32 DomainRefusePasswordChange:1 = FormatString("  (%s) %s", this.ToBitString, this?"Password can NOT be changed. Only the default password is allowed":"Password can be changed");		
				UINT32 DomainPasswordStoreCleartext:1 = FormatString("(%s) %s", this.ToBitString, this?"The encrypted, clear-text password of every user account is stored":"The encrypted, clear-text password of every user account is NOT stored");
				UINT32 DomainLockoutAdmins:1 = FormatString("         (%s) %s", this.ToBitString, this?"Administrator account is subject to the normal lockout policy":"Administrator account is NOT subject to the normal lockout policy");
				UINT32 DomainPasswordNoClearChange:1 = FormatString(" (%s) %s", this.ToBitString, "Not used");
				UINT32 DomainPasswordNoAnonChange:1 = FormatString("  (%s) %s", this.ToBitString, "Not used");
				UINT32 DomainPasswordComplex:1 = FormatString("       (%s) %s", this.ToBitString, this?"Password must have a combination of at least two of the following types of characters: Uppercase/Lowercase/Numeric characters":"Password can be of any combination of characters");
			}
		}
	}
}

Table SAMRDomainInformationClassTypeTable( Value, Description )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "0x%04X - DomainPasswordInformation %s", Value, Description ? "- The domain information type is DomainPasswordInformation" : "");
		Case 0x0002: FormatString( "0x%04X - DomainGeneralInformation %s", Value, Description ? "- The domain information type is SAMRSamprDomainGeneralInformation" : "");
		Case 0x0003: FormatString( "0x%04X - DomainLogoffInformation %s", Value, Description ? "- The domain information type is DomainLogoffInformation" : "");
		Case 0x0004: FormatString( "0x%04X - DomainOemInformation %s", Value, Description ? "- The domain information type is SAMRSamprDomainOEMInformation" : "" );
		Case 0x0005: FormatString( "0x%04X - DomainNameInformation %s", Value, Description ? "- The domain information type is SAMRSamprDomainNameInformation" : "" );
		Case 0x0006: FormatString( "0x%04X - DomainReplicationInformation %s", Value, Description ? "- The domain information type is SAMRSamprDomainReplicationInformation" : "" );
		Case 0x0007: FormatString( "0x%04X - DomainServerRoleInformation %s",Value,Description ? "- The domain information type is DomainServerRoleInformation" : "");
		Case 0x0008: FormatString( "0x%04X - DomainModifiedInformation %s",Value,Description ? "- The domain information type is DomainModifiedInformation" : "" );
		Case 0x0009: FormatString( "0x%04X - DomainStateInformation %s",Value,Description ? "- The domain information type is DomainStateInformation" : "" );
		Case 0x000A: FormatString( "0x%04X - DomainUasInformation %s",Value,Description ? "- No longer used" : "" );
		Case 0x000B: FormatString( "0x%04X - DomainGeneralInformation2 %s",Value,Description ? "- The domain information type is SAMRSamprDomainGeneralInformation2" : "" );
		Case 0x000C: FormatString( "0x%04X - DomainLockoutInformation %s",Value,Description ? "- The domain information type is SAMRSamprDomainLockoutInformation" : "" );
		Case 0x000D: FormatString( "0x%04X - DomainModifiedInformation2 %s",Value,Description ? "- The domain information type is DomainModifiedInformation2" : "" );
		Default    : FormatString( "0x%04X - No Description Available", Value );
	}
}

Table SAMRGroupInformationClassTypeTable( Value, Description )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "0x%04X - GroupGeneralInformation %s", Value, Description ? "- The group information type is SAMRSamprGroupGeneralInformation" : "" );
		Case 0x0002: FormatString( "0x%04X - GroupNameInformation %s", Value, Description ? "- The group information type is SAMRSamprGroupNameInformation" : "" );
		Case 0x0003: FormatString( "0x%04X - GroupAttributeInformation %s", Value, Description ? "- The group information type is GroupAttributeInformation" : "" );
		Case 0x0004: FormatString( "0x%04X - GroupAdminCommentInformation %s", Value, Description ? "- The group information type is SAMRSamprGroupAdminCommentInformation" : "" );
		Case 0x0005: FormatString( "0x%04X - GroupReplicationInformation %s", Value, Description ? "- The group information type is SAMRSamprGroupGeneralInformation" : "" );
		Default    : FormatString( "0x%04X - No Description Available", Value );
	}
}

Table SAMRAliasInformationClassTypeTable( Value, Description )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "0x%04X - AliasGeneralInformation %s", Value, Description ? "- The alias information type is SAMRSamprAliasGeneralInformation" : "" );
		Case 0x0002: FormatString( "0x%04X - AliasNameInformation %s", Value, Description ? "- The alias information type is SAMRSamprAliasNameInformation" : "" );
		Case 0x0003: FormatString( "0x%04X - AliasAdminCommentInformation %s", Value, Description ? "- The alias information type is SAMRSamprAliasAdminCommentInformation" : "" );
		Default    : FormatString( "0x%04X - No Description Available", Value );
	}
}

Table SAMRUserInformationClassTypeTable( Value,Description )
{
	Switch( Value )
	{
		Case 0x0001: FormatString( "0x%04X - UserGeneralInformation %s", Value, Description ? "- User information type is SAMRSamprUserGeneralInformation" : "" );
		Case 0x0002: FormatString( "0x%04X - UserPreferencesInformation %s", Value, Description ? "- User information type is SAMRSamprUserPreferencesInformation" : "" );
		Case 0x0003: FormatString( "0x%04X - UserLogonInformation %s", Value, Description ? "- User information type is SAMRSamprUserLogonInformation" : "" );
		Case 0x0004: FormatString( "0x%04X - UserLogonHoursInformation %s", Value, Description ? "- User information type is SAMRSamprUserLogonHoursInformation" : "" );
		Case 0x0005: FormatString( "0x%04X - UserAccountInformation %s", Value, Description ? "- User information type is SAMRSamprUserAccountInformation" : "" );
		Case 0x0006: FormatString( "0x%04X - UserNameInformation %s", Value, Description ? "- User information type is SAMRSamprUserNameInformation" : "" );
		Case 0x0007: FormatString( "0x%04X - UserAccountNameInformation %s", Value, Description ? "- User information type is UserAccountNameInformation" : "" );
		Case 0x0008: FormatString( "0x%04X - UserFullNameInformation %s", Value, Description ? "- User information type is UserFullNameInformation" : "" );
		Case 0x0009: FormatString( "0x%04X - UserPrimaryGroupInformation %s", Value, Description ? "- User information type is UserPrimaryGroupInformation" : "" );
		Case 0x000A: FormatString( "0x%04X - UserHomeInformation %s", Value, Description ? "- User information type is SAMRSamprUserHomeInformation" : "" );
		Case 0x000B: FormatString( "0x%04X - UserScriptInformation %s", Value, Description ? "- User information type is SAMRSamprUserScriptInformation" : "" );
		Case 0x000C: FormatString( "0x%04X - UserProfileInformation %s", Value, Description ? "- User information type is SAMRSamprUserProfileInformation" : "" );
		Case 0x000D: FormatString( "0x%04X - UserAdminCommentInformation %s", Value, Description ? "- User information type is SAMRSamprUserAdminCommentInformation" : "" );
		Case 0x000E: FormatString( "0x%04X - UserWorkStationsInformation %s", Value, Description ? "- User information type is SAMRSamprUserWorkstationsInformation" : "" );
		Case 0x000F: FormatString( "0x%04X - UserSetPasswordInformation %s", Value, Description ? "- Not used":""); 
		Case 0x0010: FormatString( "0x%04X - UserControlInformation %s", Value, Description ? "- User information type is UserControlInformation" : "");
		Case 0x0011: FormatString( "0x%04X - UserExpiresInformation %s", Value, Description ? "- User information type is UserExpiresInformation" : "" );
		Case 0x0012: FormatString( "0x%04X - UserInternal1Information %s", Value, Description ? "- User information type is SAMRSamprUserInternal1Information" : "" );
		Case 0x0014: FormatString( "0x%04X - UserParametersInformation %s", Value, Description ? "- User information type is SAMRSamprUserParametersInformation" : "" );
		Case 0x0015: FormatString( "0x%04X - UserAllInformation %s", Value,  Description ? "- User information type is SAMRSamprUserAllInformation" : "");
		Case 0x0016: FormatString( "0x%04X - UserInternal3Information %s", Value, Description ? "- User information type is SAMRSamprUserInternal3Information" : "" );
		Case 0x0017: FormatString( "0x%04X - UserInternal4Information %s", Value, Description ? "- User information type is SAMRSamprUserInternal4Information" : "" );
		Case 0x0018: FormatString( "0x%04X - UserInternal5Information %s", Value, Description ? "- User information type is SAMRSamprUserInternal5Information" : "" );
		Case 0x0019: FormatString( "0x%04X - UserInternal4InformationNew %s", Value, Description ? "- User information type is SAMRSamprUserInternal4InformationNew" : "" );
		Case 0x001A: FormatString( "0x%04X - UserInternal5InformationNew %s", Value, Description ? "- User information type is SAMRSamprUserInternal5InformationNew" : "" );
		Default    : FormatString( "0x%04X - No Description Available", Value );
	}
}

Struct SAMRDomainSpecificRights = SAMRDomainSpecificRightsTable(UINT32(FrameData,FrameOffset))
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 DomainReadPasswordParameters:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the password parameters of the domain":"Do NOT allow reading the password parameters of the domain");
				UINT16 DomainWritePasswordParams:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the password parameters of the domain":"DO NOT allow modifying the password parameters of the domain");
				UINT16 DomainReadOtherParameters:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow reading the parameters other than domain parameters":"Do NOT allow reading the parameters other than domain parameters");
				UINT16 DomainWriteOtherParameters:1 = FormatString("  (%s) %s", this.ToBitString, this?"Allow modifying the parameters other than domain parameters":"Do NOT allow modifying the parameters other than domain parameters");
				UINT16 DomainCreateUser:1 = FormatString("            (%s) %s", this.ToBitString, this?"Allow creating and adding a new user to the domain":"Do NOT allow creating and adding a new user to the domain");
				UINT16 DomainCreateGroup:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow creating and adding a new group to the domain":"Do NOT allow creating and adding a new group to the domain");
				UINT16 DomainCreateAlias:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow creating and adding a new alias to the domain":"Do NOT allow creating and adding a new alias to the domain");
				UINT16 DomainGetAliasMembership:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow getting a list of aliases of which one or more SIDs is a member":"Do NOT allow getting a list of aliases of which one or more SIDs is a member");
				UINT16 DomainListAccounts:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow obtaining a list of a domain's accounts(user,group or alias)":"Do NOT allow obtaining a list of a domain's accounts(user,group or alias)");
				UINT16 DomainLookup:1 = FormatString("                (%s) %s", this.ToBitString, this?"Allow the lookup of names or SIDs within the domain":"Do NOT allow the lookup of names or SIDs within the domain");
				UINT16 DomainAdministerServer:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow administration of the server characteristics of the domain":"Do NOT allow administration of the server characteristics of the domain");
				UINT16 Reserved:5 = FormatString("                    (%s)", this.ToBitString);
			}
			MSRPCAccessRights AccessRights;
		};
		Default:
		Struct
		{
			MSRPCAccessRights AccessRights;
			UINT16 SpecificRights = FormatString( "0x%04X", UINT16( FrameData, FrameOffset ) )
			{
				UINT16 Reserved:5 = FormatString("                    (%s)", this.ToBitString);
				UINT16 DomainAdministerServer:1 = FormatString("      (%s) %s", this.ToBitString, this?"Allow administration of the server characteristics of the domain":"Do NOT allow administration of the server characteristics of the domain");
				UINT16 DomainLookup:1 = FormatString("                (%s) %s", this.ToBitString, this?"Allow the lookup of names or SIDs within the domain":"Do NOT allow the lookup of names or SIDs within the domain");
				UINT16 DomainListAccounts:1 = FormatString("          (%s) %s", this.ToBitString, this?"Allow obtaining a list of a domain's accounts(user,group or alias)":"Do NOT allow obtaining a list of a domain's accounts(user,group or alias)");
				UINT16 DomainGetAliasMembership:1 = FormatString("    (%s) %s", this.ToBitString, this?"Allow getting a list of aliases of which one or more SIDs is a member":"Do NOT allow getting a list of aliases of which one or more SIDs is a member");
				UINT16 DomainCreateAlias:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow creating and adding a new alias to the domain":"Do NOT allow creating and adding a new alias to the domain");
				UINT16 DomainCreateGroup:1 = FormatString("           (%s) %s", this.ToBitString, this?"Allow creating and adding a new group to the domain":"Do NOT allow creating and adding a new group to the domain");
				UINT16 DomainCreateUser:1 = FormatString("            (%s) %s", this.ToBitString, this?"Allow creating and adding a new user to the domain":"Do NOT allow creating and adding a new user to the domain");
				UINT16 DomainWriteOtherParameters:1 = FormatString("  (%s) %s", this.ToBitString, this?"Allow modifying the parameters other than domain parameters":"Do NOT allow modifying the parameters other than domain parameters");
				UINT16 DomainReadOtherParameters:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow reading the parameters other than domain parameters":"Do NOT allow reading the parameters other than domain parameters");
				UINT16 DomainWritePasswordParams:1 = FormatString("   (%s) %s", this.ToBitString, this?"Allow modifying the password parameters of the domain":"DO NOT allow modifying the password parameters of the domain");
				UINT16 DomainReadPasswordParameters:1 = FormatString("(%s) %s", this.ToBitString, this?"Allow reading the password parameters of the domain":"Do NOT allow reading the password parameters of the domain");
			}
		};
	}
}

//
//	Sampr_RID_ENUMERATION
//	Alignment: None
//
Struct SAMRSamprRidEnumeration = FormatString("RelativeID: %u",RelativeId)
{
	NdrAlign Pad;
	UINT32 RelativeId;
	NdrUnicodeStringHeader Header;
}

Table SAMRDomainSpecificRightsTable( Value )
{
	Switch( Value )
	{
		Case 0x00020301: FormatString( "0x%08X - DOMAIN_ALL_EXECUTE - The specified accesses for a GENERIC_EXECUTE request", Value );
		Case 0x0002047A: FormatString( "0x%08X - DOMAIN_ALL_WRITE - The specified accesses for a GENERIC_WRITE request", Value );
		Case 0x00020084: FormatString( "0x%08X - DOMAIN_ALL_READ - The specified accesses for a GENERIC_READ request", Value );
		Case 0x000F07FF: FormatString( "0x%08X - DOMAIN_ALL_ACCESS - The specified accesses for a GENERIC_ALL request", Value );
		Default        : FormatString( "0x%08X", Value );
	}
}

Table SAMRServerSpecificRightsTable( Value )
{
	Switch( Value )
	{
		Case 0x00020021: FormatString( "0x%08X - SERVER_ALL_EXECUTE - The specified accesses for a GENERIC_EXECUTE request", Value );
		Case 0x0002000E: FormatString( "0x%08X - SERVER_ALL_WRITE - The specified accesses for a GENERIC_WRITE request", Value );
		Case 0x00020010: FormatString( "0x%08X - SERVER_ALL_READ - The specified accesses for a GENERIC_READ request", Value );
		Case 0x000F003F: FormatString( "0x%08X - SERVER_ALL_ACCESS - The specified accesses for a GENERIC_ALL request", Value );
		Default        : FormatString( "0x%08X", Value );
	}
}

Struct SAMRSecurityInformation  = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT32 SecurityInformation  = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
			{
				UINT32 OwnerSecurityInformation:1 = FormatString("(%s) %s", this.ToBitString, "Security identifier (SID) of the object's owner");
				UINT32 GroupSecurityInformation:1 = FormatString("(%s) %s", this.ToBitString,"SID of the owner's primary group");
				UINT32 DaclSecurityInformation:1 = FormatString(" (%s) %s", this.ToBitString,"Discretionary access-control list (DACL) of the object");
				UINT32 SaclSecurityInformation:1 = FormatString(" (%s) %s", this.ToBitString,"System access-control list (SACL) of the object");
				UINT32 Reserved:28 = FormatString("                (%s)", this.ToBitString);
			}
		}
		Default:
		Struct
		{
			UINT32 SecurityInformation  = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
			{
				UINT32 Reserved:28 = FormatString("                (%s)", this.ToBitString);
				UINT32 SaclSecurityInformation:1 = FormatString(" (%s) %s", this.ToBitString,"System access-control list (SACL) of the object");
				UINT32 DaclSecurityInformation:1 = FormatString(" (%s) %s", this.ToBitString,"Discretionary access-control list (DACL) of the object");
				UINT32 GroupSecurityInformation:1 = FormatString("(%s) %s", this.ToBitString,"SID of the owner's primary group");
				UINT32 OwnerSecurityInformation:1 = FormatString("(%s) %s", this.ToBitString, "Security identifier (SID) of the object's owner");
			}
		}
	}
}

Struct SAMRSamprRpcUnicodeString = FormatString("Entries: %u",Length.ActualCount)
{
	NdrConformantVarying Length;
	SAMRSamprUnicodeStringArray( Length.ActualCount ) Names;
}

Struct SAMRSamprUnicodeStringArray( Size ) = FormatString("Entries: %u",SAMRSamprUnicodeStringArrayLoop)
{
	[SAMRSamprUnicodeStringArrayLoop = 0, RpcUnicodeLoop = 0]
	NdrUnicodeStringHeader UnicodeStringPointer[ Size ];
	While SAMRSamprUnicodeStringArrayWhileLoop[ SAMRSamprUnicodeStringArrayLoop < RpcUnicodeLoop ]
	{
		[SAMRSamprUnicodeStringArrayLoop = SAMRSamprUnicodeStringArrayLoop + 1]
		Switch {
			Case NdrUnicodeStringHeaderArray$[SAMRSamprUnicodeStringArrayLoop - 1] > 0: [SamprNameString = Name.toString] NdrWideString Name;
		}
	}
}

//
//	Sampr_ULONG_ARRAY
//	Alignment: NdrAlign
//
Struct SAMRSamprUlongUseArray( SidType ) = FormatString( "Count: %u", Count )
{
	[SAMRSamprUseArrayLoop = 0, Post.SAMRSamprUseArrayCount = Count]
	UINT32 Count;
	NdrPtrToConformant ArrayPointer;
	Switch {
		Case ArrayPointer.ReferentID > 0:
		Struct
		{
			While SAMRSamprUseArrayWhileLoop[SAMRSamprUseArrayLoop < Count]
			{
				[SAMRSamprUseArrayLoop = SAMRSamprUseArrayLoop + 1]
				UINT32 Element = FormatString( "%s", SidType ? SamrDomainAccountTypeTable( this ) : this );
			}
		}
	}
}

//
//	Sampr_GROUP_GENERAL_INFORMATION
//	Alignment: NdrAlign
//
[SamprGroupInformationSummary = FormatString( "%s, GroupAccountName: %s, MemberCount: %u", SAMRSamprGroupInformationClass, SAMRSamprGroupAccountName,MemberCount )]
Struct SAMRSamprGroupGeneralInformation = FormatString( "GroupAccountName: %s, AdminComment: %s, MemberCount: %u", SAMRSamprGroupAccountName, SAMRSamprAdminComment, MemberCount )
{
	NdrUnicodeStringHeader NameHeader;
	SAMRGroupAttributes Attributes;
	UINT32 MemberCount;
	NdrUnicodeStringHeader AdminCommentHeader;
	Switch {
		Case NameHeader.BufferPtr.ReferentID > 0: [SAMRSamprGroupAccountName = Name.toString]NdrWideString Name;
	}

	Switch {
		Case AdminCommentHeader.BufferPtr.ReferentID > 0: [SAMRSamprAdminComment = AdminComment.toString]NdrWideString AdminComment;
	}
}

Struct SAMRGroupAttributes = FormatString( "0x%08X", UINT32( FrameData, FrameOffset ) )
{
	Switch( Property.MSRPCByteOrder )
	{
		Case LittleEndian:
		Struct
		{
			UINT32 Attributes = FormatString( "0x%08X", this )
			{
				UINT32 SEGroupMandatory:1  = FormatString("       (%s) %s", this.ToBitString,this?"Group can NOT have the SEGroupEnabled attribute cleared":"Group can have the SEGroupEnabled attribute cleared");
				UINT32 SEGroupEnabledByDefault:1  = FormatString("(%s) %s", this.ToBitString,this?"Group is ENABLED for access checks by default":"Group is DISABLED for access checks by default");
				UINT32 SEGroupEnabled:1  = FormatString("         (%s) %s", this.ToBitString,this?"Group is ENABLED for access checks":"Group is DISABLED for access checks");
				UINT32 Reserved:29 = FormatString("               (%s)", this.ToBitString);
//				Removed according to ProtoDoc #456 "They are used by LSA internally when marking SIDs with special effects within a token"
//				UINT32 SEGroupOwner:1  = FormatString("           (%s) %s", this.ToBitString,this?"Group's token account is the owner of the group, or the group can be assigned as the owner of the account":"Group's token account is NOT the owner of the group, or the group can NOT be assigned as the owner of the account");
//				UINT32 SEGroupUseForDenyOnly:1  = FormatString("  (%s) %s", this.ToBitString,this?"Windows 2000/XP: Group is deny-only in a restricted token. If this attribute is set, SEGroupEnabled is not set, and the group can NOT be re-enabled":"Windows 2000/XP:The group can be re-enabled");
//				UINT32 Reserved:24 = FormatString("               (%s)", this.ToBitString);
//				UINT32 SEGroupResource:1 = FormatString("        (%s) %s", this.ToBitString,this?"Group is a resource group":"Group is NOT a resource group");
//				UINT32 SEGroupLogonID:2 = FormatString("         (%s) %s", this.ToBitString,this?"Windows 2000/XP: Group is a domain local group":"Windows 2000/XP: Group is NOT a domain local group");
			}
		}
		Default:
		Struct
		{
			UINT32 Attributes = FormatString( "0x%08X", this )
			{
//				Removed according to ProtoDoc #456 "They are used by LSA internally when marking SIDs with special effects within a token"
//				UINT32 SEGroupLogonID:2 = FormatString("         (%s) %s", this.ToBitString,this?"Windows 2000/XP: Group is a domain local group":"Windows 2000/XP: Group is NOT a domain local group");
//				UINT32 SEGroupResource:1 = FormatString("        (%s) %s", this.ToBitString,this?"Group is a resource group":"Group is NOT a resource group");
//				UINT32 Reserved:24 = FormatString("               (%s)", this.ToBitString);
//				UINT32 SEGroupUseForDenyOnly:1  = FormatString("  (%s) %s", this.ToBitString,this?"Windows 2000/XP: Group is deny-only in a restricted token. If this attribute is set, SEGroupEnabled is not set, and the group can NOT be re-enabled":"Windows 2000/XP:The group can be re-enabled");
//				UINT32 SEGroupOwner:1  = FormatString("           (%s) %s", this.ToBitString,this?"Group's token account is the owner of the group, or the group can be assigned as the owner of the account":"Group's token account is NOT the owner of the group, or the group can NOT be assigned as the owner of the account");
				UINT32 Reserved:29 = FormatString("               (%s)", this.ToBitString);
				UINT32 SEGroupEnabled:1  = FormatString("         (%s) %s", this.ToBitString,this?"Group is ENABLED for access checks":"Group is DISABLED for access checks");
				UINT32 SEGroupEnabledByDefault:1  = FormatString("(%s) %s", this.ToBitString,this?"Group is ENABLED for access checks by default":"Group is DISABLED for access checks by default");
				UINT32 SEGroupMandatory:1  = FormatString("       (%s) %s", this.ToBitString,this?"Group can NOT have the SEGroupEnabled attribute cleared":"Group can have the SEGroupEnabled attribute cleared");
			}
		}
	}
}

Table SamrDomainAccountTypeTable( Value )
{
	Switch( Value )
	{
		Case 0x00000001: FormatString( "0x%08X - SidTypeUser - User account", Value );
		Case 0x00000002: FormatString( "0x%08X - SidTypeGroup - Group account", Value );
		Case 0x00000003: FormatString( "0x%08X - SidTypeDomain - Domain account", Value );
		Case 0x00000004: FormatString( "0x%08X - SidTypeAlias - Alias account", Value );
		Case 0x00000005: FormatString( "0x%08X - SidTypeWellKnownGroup - Well-known group account", Value );
		Case 0x00000006: FormatString( "0x%08X - SidTypeDeletedAccount - Account that has been deleted", Value );
		Case 0x00000007: FormatString( "0x%08X - SidTypeInvalid - Invalid account", Value );
		Case 0x00000008: FormatString( "0x%08X - SidTypeUnknown - Unknown account", Value );
		Case 0x00000009: FormatString( "0x%08X - SidTypeComputer - Computer account", Value );
		Default        : FormatString( "0x%08X - No Description Available", Value );
	}
}



//
//	Sampr_USER_GENERAL_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, PrimaryGroupId: %u", UserName.toString, FullName.toString, PrimaryGroupId )]
Struct SAMRSamprUserGeneralInformation = FormatString( "UserName: %s, FullName: %s, PrimaryGroupId: %u", UserName.toString, FullName.toString, PrimaryGroupId )
{
	[Post.SamrPointerToUserNameHeader = UserNameHeader.BufferPtr.ReferentID?UserNameHeader.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SamrPointerToFullNameHeader = FullNameHeader.BufferPtr.ReferentID?FullNameHeader.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader FullNameHeader;
	UINT32 PrimaryGroupId;
	[Post.SamrPointerToAdminCommentHeader = AdminCommentHeader.BufferPtr.ReferentID?AdminCommentHeader.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader AdminCommentHeader;
	[Post.SamrPointerToUserCommentHeader = UserCommentHeader.BufferPtr.ReferentID?UserCommentHeader.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader UserCommentHeader;

	Switch {
		Case SamrPointerToUserNameHeader > 0: NdrWideString UserName;
	}

	Switch {
		Case SamrPointerToFullNameHeader > 0: NdrWideString FullName;
	}

	Switch {
		Case SamrPointerToAdminCommentHeader > 0: NdrWideString AdminComment;
	}

	Switch {
		Case SamrPointerToUserCommentHeader > 0: NdrWideString UserComment;
	}
}

//
//	Sampr_USER_PREFERENCES_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "Reserved1: %s, CountryCode: %u, CodePage: %u", Reserved1.toString, CountryCode, CodePage )]
Struct SAMRSamprUserPreferencesInformation = FormatString( "Reserved1: %s, CountryCode: %u, CodePage: %u", Reserved1.toString, CountryCode, CodePage )
{
	[Post.SamrPointerToUserCommentHeader = UserCommentHeader.BufferPtr.ReferentID?UserCommentHeader.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader UserCommentHeader;
	[Post.SamrPointerToReserved1Header = Reserved1Header.BufferPtr.ReferentID?Reserved1Header.BufferPtr.ReferentID:0]
	NdrUnicodeStringHeader Reserved1Header;

	UINT16 CountryCode;
	UINT16 CodePage;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SamrPointerToUserCommentHeader > 0: NdrWideString UserComment;
	}

	Switch {
		Case SamrPointerToReserved1Header > 0: NdrWideString Reserved1;
	}
}

//
//	Sampr_USER_LOGON_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )]
Struct SAMRSamprUserLogonInformation = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )
{
	[Post.SamrPointerToUserNameHeader = UserNameHeader.BufferPtr.ReferentID ? UserNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SamrPointerToFullNameHeader = FullNameHeader.BufferPtr.ReferentID ? FullNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader FullNameHeader;
	UINT32 UserId;
	UINT32 PrimaryGroupId;
	[Post.SamrPointerToHomeDirectoryHeader = HomeDirectoryHeader.BufferPtr.ReferentID ? HomeDirectoryHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SamrPointerToHomeDirectoryDriveHeader = HomeDirectoryDriveHeader.BufferPtr.ReferentID ? HomeDirectoryDriveHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;
	[Post.SamrPointerToScriptPathHeader = ScriptPathHeader.BufferPtr.ReferentID ? ScriptPathHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader ScriptPathHeader;
	[Post.SamrPointerToProfilePathHeader = ProfilePathHeader.BufferPtr.ReferentID ? ProfilePathHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader ProfilePathHeader;
	[Post.SamrPointerToWorkStationsHeader = WorkStationsHeader.BufferPtr.ReferentID ? WorkStationsHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader WorkStationsHeader;
	FILETIME LastLogon;
	FILETIME LastLogoff;
	FILETIME PasswordLastSet;
	FILETIME PasswordCanChange;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000) : 
		Struct {
			FILETIME PasswordMustChange = FormatString("Password never expires");
		};

		Default:
		Struct {
			FILETIME PasswordMustChange;
		};
	}

	Struct SAMRSamprLogonHoursHeader = FormatString("UnitsPerWeek: %s",SamrUnitsPerWeekTable(UnitsPerWeek,FALSE))
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE );
		[Post.SamrPointerToLogonHours = PointerToLogonHours.ReferentID?PointerToLogonHours.ReferentID:0]
		NdrPtr PointerToLogonHours;
	}

	UINT16 BadPasswordCount;
	UINT16 LogonCount;
	SAMRUserAccountControl UserAccountControl;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SamrPointerToUserNameHeader > 0: NdrWideString UserName;
	}

	Switch {
		Case SamrPointerToFullNameHeader > 0: NdrWideString FullName;
	}

	Switch {
		Case SamrPointerToHomeDirectoryHeader > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SamrPointerToHomeDirectoryDriveHeader > 0: NdrWideString HomeDirectoryDrive;
	}

	Switch {
		Case SamrPointerToScriptPathHeader > 0: NdrWideString ScriptPath;
	}

	Switch {
		Case SamrPointerToProfilePathHeader > 0: NdrWideString ProfilePath;
	}

	Switch {
		Case SamrPointerToWorkStationsHeader > 0: NdrWideString WorkStations;
	}

	Switch
	{
		Case SamrPointerToLogonHours > 0:
		Struct
		{
			NdrConformantVarying ArrayInfo;
			BLOB(ArrayInfo.ActualCount) LogonHours;
		}
	}
}

//
//	Sampr_USER_LOGON_HOURS_INFORMATION
//	Alignment: NdrAlign
//
[SamprUserInformationSummary = FormatString( "UnitsPerWeek: %s", SamrUnitsPerWeekTable( SAMRSamprLogonHours.UnitsPerWeek,FALSE ))]
Struct SAMRSamprUserLogonHoursInformation = FormatString( "UnitsPerWeek: %s", SamrUnitsPerWeekTable( SAMRSamprLogonHours.UnitsPerWeek,FALSE ))
{
	Struct SAMRSamprLogonHours
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE);
		NdrPtr PointerToLogonHours;
		Switch
		{
			Case PointerToLogonHours.ReferentID > 0:
			Struct
			{
				NdrConformantVarying ArrayInfo;
				BLOB( ArrayInfo.ActualCount ) LogonHours;
			}
		}
	}
}

//
//	Sampr_USER_ACCOUNT_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )]
Struct SAMRSamprUserAccountInformation = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )
{
	[Post.SamrPointerToUserNameHeader = UserNameHeader.BufferPtr.ReferentID ? UserNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SamrPointerToFullNameHeader = FullNameHeader.BufferPtr.ReferentID ? FullNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader FullNameHeader;
	UINT32 UserId;
	UINT32 PrimaryGroupId;
	[Post.SamrPointerToHomeDirectoryHeader = HomeDirectoryHeader.BufferPtr.ReferentID ? HomeDirectoryHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SamrPointerToHomeDirectoryDriveHeader = HomeDirectoryDriveHeader.BufferPtr.ReferentID ? HomeDirectoryDriveHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;
	[Post.SamrPointerToScriptPathHeader = ScriptPathHeader.BufferPtr.ReferentID ? ScriptPathHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader ScriptPathHeader;
	[Post.SamrPointerToProfilePathHeader = ProfilePathHeader.BufferPtr.ReferentID ? ProfilePathHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader ProfilePathHeader;
	[Post.SamrPointerToAdminCommentHeader = AdminCommentHeader.BufferPtr.ReferentID ? AdminCommentHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader AdminCommentHeader;
	[Post.SamrPointerToWorkStationsHeader = WorkStationsHeader.BufferPtr.ReferentID ? WorkStationsHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader WorkStationsHeader;

	FILETIME LastLogon;
	FILETIME LastLogoff;

	Struct SAMRSamprLogonHoursHeader = FormatString("UnitsPerWeek: %s",SamrUnitsPerWeekTable( UnitsPerWeek,FALSE ))
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE );
		[Post.SamrPointerToLogonHours = PointerToLogonHours.ReferentID ? PointerToLogonHours.ReferentID : 0]
		NdrPtr PointerToLogonHours;
	}

	UINT16 BadPasswordCount;
	UINT16 LogonCount;

	FILETIME PasswordLastSet;
	Switch
	{
		Case UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF:
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString("Account never expires");
		};

		Case UINT64(FrameData,Offset) == 0x0000000000000000:
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString("Account never expires");
		};

		Default:
		Struct {
			FILETIME AccountExpires;
		};
	}

	SAMRUserAccountControl UserAccountControl;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SamrPointerToUserNameHeader > 0: NdrWideString UserName;
	}

	Switch {
		Case SamrPointerToFullNameHeader > 0: NdrWideString FullName;
	}

	Switch {
		Case SamrPointerToHomeDirectoryHeader > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SamrPointerToHomeDirectoryDriveHeader > 0: NdrWideString HomeDirectoryDrive;
	}

	Switch {
		Case SamrPointerToScriptPathHeader > 0: NdrWideString ScriptPath;
	}

	Switch {
		Case SamrPointerToProfilePathHeader > 0: NdrWideString ProfilePath;
	}

	Switch {
		Case SamrPointerToAdminCommentHeader > 0: NdrWideString AdminComment;
	}

	Switch {
		Case SamrPointerToWorkStationsHeader > 0: NdrWideString WorkStations;
	}

	Switch
	{
		Case SamrPointerToLogonHours > 0:
		Struct
		{
			NdrConformantVarying ArrayInfo;
			BLOB(ArrayInfo.ActualCount) LogonHours;
		}
	}
}

//
//	Sampr_USER_NAME_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s", UserName.toString, FullName.toString )]
Struct SAMRSamprUserNameInformation = FormatString( "UserName: %s, FullName: %s", UserName.toString, FullName.toString )
{
	[Post.SamrPointerToUserNameHeader = UserNameHeader.BufferPtr.ReferentID ? UserNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SamrPointerToFullNameHeader = FullNameHeader.BufferPtr.ReferentID ? FullNameHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader FullNameHeader;

	Switch {
		Case SamrPointerToUserNameHeader > 0: NdrWideString UserName;
	}

	Switch {
		Case SamrPointerToFullNameHeader > 0: NdrWideString FullName;
	}
}

//
//	Sampr_USER_A_NAME_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "UserName: %s", UserName.toString )]
Struct SAMRSamprUserANameInformation = FormatString( "UserName: %s", UserName.toString ) {
	NdrUnicodeString UserName;
}

[SamprUserInformationSummary = FormatString( "FullName: %s", FullName.toString )]
Struct SAMRSamprUserFNameInformation = FormatString( "FullName: %s", FullName.toString ) {
	NdrUnicodeString Fullname;
}

[SamprUserInformationSummary = FormatString( "PrimaryGroupId: %u", PrimaryGroupId )]
Struct UserPrimaryGroupInformation = FormatString( "PrimaryGroupId: %u", PrimaryGroupId ) {
	UINT32 PrimaryGroupId;
}

//
//	Sampr_USER_HOME_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "HomeDirectory: %s, HomeDirectoryDrive: %s", HomeDirectory.toString, HomeDirectoryDrive.toString )]
Struct SAMRSamprUserHomeInformation = FormatString( "HomeDirectory: %s, HomeDirectoryDrive: %s", HomeDirectory.toString, HomeDirectoryDrive.toString )
{
	[Post.SamrPointerToHomeDirectoryHeader = HomeDirectoryHeader.BufferPtr.ReferentID ? HomeDirectoryHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SamrPointerToHomeDirectoryDriveHeader = HomeDirectoryDriveHeader.BufferPtr.ReferentID ? HomeDirectoryDriveHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;

	Switch {
		Case SamrPointerToHomeDirectoryHeader > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SamrPointerToHomeDirectoryDriveHeader > 0: NdrWideString HomeDirectoryDrive;
	}
}

//
//  SAMPR_USER_SCRIPT_INFORMATION
//  Alignment: None
//
[SamprUserInformationSummary = FormatString( "ScriptPath: %s", ScriptPath.toString )]
Struct SAMRSamprUserScriptInformation = FormatString( "ScriptPath: %s",ScriptPath.toString ) {
	NdrUnicodeString ScriptPath;
}

//
//  SAMPR_USER_PROFILE_INFORMATION
//  Alignment: None
//
[SamprUserInformationSummary = FormatString( "ProfilePath: %s", ProfilePath.toString )]
Struct SAMRSamprUserProfileInformation  = FormatString( "ProfilePath: %s", ProfilePath.toString ) {
	NdrUnicodeString ProfilePath;
}

//
//  SAMPR_USER_ADMIN_COMMENT_INFORMATION
//  Alignment: None
//
[SamprUserInformationSummary = FormatString( "AdminComment: %s", AdminComment.toString )]
Struct SAMRSamprUserAdminCommentInformation =  FormatString( "AdminComment: %s", AdminComment.toString ) {
	NdrUnicodeString AdminComment;
}

//
//  SAMPR_USER_WORKSTATIONS_INFORMATION
//  Alignment: None
//
[SamprUserInformationSummary = FormatString( "WorkStation: %s", WorkStation.toString )]
Struct SAMRSamprUserWorkstationsInformation  = FormatString( "WorkStation: %s", WorkStation.toString ) {
	NdrUnicodeString WorkStation;
}

//
//  USER_CONTROL_INFORMATION
//  Alignment: 4
//
[SamprUserInformationSummary = FormatString( "UserAccountControl: %s", UserAccountControl.toString )] 
Struct SAMRUserControlInformation = FormatString( "UserAccountControl: %s", UserAccountControl.toString ) {
	SAMRUserAccountControl UserAccountControl;
}

//
//  USER_EXPIRES_INFORMATION
//  Alignment: 4
//
[SamprUserInformationSummary = FormatString( "AccountExpires: %s", AccountExpires.toString )]
Struct SAMRUserExpiresInformation  = FormatString( "AccountExpires: %s", AccountExpires ) 
{
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString("Account never expires");
		};

		Default:
		Struct {
			FILETIME AccountExpires;
		};
	}
}

//
//	Sampr_USER_INTERNAL1_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "NtPasswordPresent: %s, LmPasswordPresent: %s, PasswordExpired:%s", NtPasswordPresent.toString, LmPasswordPresent.toString, PasswordExpired.toString )]
Struct SAMRSamprUserInternal1Information = FormatString( "NtPasswordPresent: %s, LmPasswordPresent: %s, PasswordExpired:%s", NtPasswordPresent.toString, LmPasswordPresent.toString, PasswordExpired.toString )
{
	[Post.SamrPointerToEncryptedNtOwfPassword = PointerToEncryptedNtOwfPassword.ReferentID ? PointerToEncryptedNtOwfPassword.ReferentID : 0]
	NdrPtr PointerToEncryptedNtOwfPassword;
	[Post.SamrPointerToEncryptedLmOwfPassword = PointerToEncryptedLmOwfPassword.ReferentID ? PointerToEncryptedLmOwfPassword.ReferentID : 0]
	NdrPtr PointerToEncryptedLmOwfPassword;

	BOOLEAN NtPasswordPresent;
	BOOLEAN LmPasswordPresent;
	BOOLEAN PasswordExpired;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SamrPointerToEncryptedNtOwfPassword > 0: SAMREncryptedLmOwfPassword EncryptedNtOwfPassword;
	}

	Switch {
		Case SamrPointerToEncryptedLmOwfPassword > 0: SAMREncryptedLmOwfPassword EncryptedLmOwfPassword;
	}
}

//
//	SAMPR_USER_PARAMETERS_INFORMATION 
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "Parameters: %s", Parameters.toString )]
Struct SAMRSamprUserParametersInformation = FormatString( "Parameters: %s", Parameters.toString ) {
	NdrUnicodeString Parameters;
}

//
//	Sampr_USER_ALL_INFORMATION
//	Alignment: NDR
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, SAMRSamprLogonHoursHeader.toString )]
Struct SAMRSamprUserAllInformation = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )
{
	FILETIME LastLogon;
	FILETIME LastLogoff;
	FILETIME PasswordLastSet;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString( "Account never expires" );
		};

		Default:
		Struct {
			FILETIME AccountExpires;
		};
	}
	FILETIME PasswordCanChange;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			FILETIME PasswordMustChange = FormatString( "Password never expires" );
		};

		Default:
		Struct {
			FILETIME PasswordMustChange;
		};
	}

	[Post.SAMRSamprUserNameHeaderPointer = UserNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SAMRSamprFullNameHeaderPointer = FullNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader FullNameHeader;
	[Post.SAMRSamprHomeDirectoryHeaderPointer = HomeDirectoryHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SAMRSamprHomeDirectoryDriveHeaderPointer = HomeDirectoryDriveHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;
	[Post.SAMRSamprScriptPathHeaderPointer = ScriptPathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ScriptPathHeader;
	[Post.SAMRSamprProfilePathHeaderPointer = ProfilePathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ProfilePathHeader;
	[Post.SAMRSamprAdminCommentHeaderPointer = AdminCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader AdminCommentHeader;
	[Post.SAMRSamprWorkStationsHeaderPointer = WorkStationsHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader WorkStationsHeader;
	[Post.SAMRSamprUserCommentHeaderPointer = UserCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserCommentHeader;
	[Post.SAMRSamprParametersHeaderPointer = ParametersHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ParametersHeader;
	[Post.SAMRSamprLmOwfPasswordHeaderPointer = LmOwfPasswordHeader.BufferPtr.ReferentID ? LmOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader LmOwfPasswordHeader;
	[Post.SAMRSamprNtOwfPasswordHeaderPointer = NtOwfPasswordHeader.BufferPtr.ReferentID ? NtOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader NtOwfPasswordHeader;
	[Post.SAMRSamprPrivateDataHeaderPointer = PrivateDataHeader.BufferPtr.ReferentID ? PrivateDataHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader PrivateDataHeader;

	Struct SAMRSamprSrSecurityDescriptor = FormatString("%s",PointerToSecurityDescriptor.toString)
	{
		UINT32 Length;
		[Post.SAMRSamprPointerToSecurityDescriptor = PointerToSecurityDescriptor.ReferentID ? PointerToSecurityDescriptor.ReferentID : 0]
		NdrPtr PointerToSecurityDescriptor;
	}

	UINT32 UserId;
	UINT32 PrimaryGroupId;
	SAMRUserAccountControl UserAccountControl;
	SAMRWhichFields WhichFields;

	Struct SAMRSamprLogonHoursHeader = FormatString("%s",SamrUnitsPerWeekTable( UnitsPerWeek,FALSE))
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE );
		[Post.SAMRSamprPointerToLogonHours = PointerToLogonHours.ReferentID ? PointerToLogonHours.ReferentID : 0]
		NdrPtr PointerToLogonHours;
	}

	UINT16 BadPasswordCount;
	UINT16 LogonCount;
	UINT16 CountryCode;
	UINT16 CodePage;

	BOOLEAN LmPasswordPresent;
	BOOLEAN NtPasswordPresent;
	BOOLEAN PasswordExpired;
	BOOLEAN PrivateDataSensitive;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad1;
	}
	Switch {
		Case SAMRSamprUserNameHeaderPointer > 0: NdrWideString UserName;
	}

	Switch {
		Case SAMRSamprFullNameHeaderPointer > 0: NdrWideString FullName;
	}

	Switch {
		Case SAMRSamprHomeDirectoryHeaderPointer > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SAMRSamprHomeDirectoryDriveHeaderPointer> 0: NdrWideString HomeDirectoryDrive;
	}

	Switch {
		Case SAMRSamprScriptPathHeaderPointer> 0: NdrWideString ScriptPath;
	}

	Switch {
		Case SAMRSamprProfilePathHeaderPointer > 0: NdrWideString ProfilePath;
	}

	Switch {
		Case SAMRSamprAdminCommentHeaderPointer > 0: NdrWideString AdminComment;
	}

	Switch {
		Case SAMRSamprWorkStationsHeaderPointer > 0: NdrWideString WorkStations;
	}

	Switch {
		Case SAMRSamprUserCommentHeaderPointer > 0: NdrWideString UserComment;
	}

	Switch {
		Case SAMRSamprParametersHeaderPointer > 0: NdrWideString Parameters;
	}

	Switch {
		Case SAMRSamprLmOwfPasswordHeaderPointer > 0: NdrWideString LmOwfPassword;
	}

	Switch {
		Case SAMRSamprNtOwfPasswordHeaderPointer > 0: NdrWideString NtOwfPassword;
	}

	Switch {
		Case SAMRSamprPrivateDataHeaderPointer > 0: NdrWideString PrivateData;
	}

	Switch {
		Case SAMRSamprPointerToSecurityDescriptor > 0: SID (TRUE) SecurityDescriptor;
	}

	Switch
	{
		Case SAMRSamprPointerToLogonHours > 0:
		Struct SAMRSamprLogonHours
		{
			NdrConformantVarying ArrayInfo;
			BLOB(ArrayInfo.ActualCount) LogonHours;
		}
	}
}

//
//	Sampr_USER_INTERNAL4_INFORMATION
//	Alignment: NDR
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )]
Struct SAMRSamprUserInternal4Information = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s, %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString,SAMRSamprLogonHoursHeader.toString )
{
	FILETIME LastLogon;
	FILETIME LastLogoff;
	FILETIME PasswordLastSet;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString( "Account never expires" );
		};

		Default:
		Struct {
			FILETIME AccountExpires;
		};
	}
	FILETIME PasswordCanChange;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			FILETIME PasswordMustChange = FormatString( "Password never expires" );
		};

		Default:
		Struct {
			FILETIME PasswordMustChange;
		};
	}

	[Post.SAMRSamprUserNameHeaderPointer = UserNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SAMRSamprFullNameHeaderPointer = FullNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader FullNameHeader;
	[Post.SAMRSamprHomeDirectoryHeaderPointer = HomeDirectoryHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SAMRSamprHomeDirectoryDriveHeaderPointer = HomeDirectoryDriveHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;
	[Post.SAMRSamprScriptPathHeaderPointer = ScriptPathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ScriptPathHeader;
	[Post.SAMRSamprProfilePathHeaderPointer = ProfilePathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ProfilePathHeader;
	[Post.SAMRSamprAdminCommentHeaderPointer = AdminCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader AdminCommentHeader;
	[Post.SAMRSamprWorkStationsHeaderPointer = WorkStationsHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader WorkStationsHeader;
	[Post.SAMRSamprUserCommentHeaderPointer = UserCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserCommentHeader;
	[Post.SAMRSamprParametersHeaderPointer = ParametersHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ParametersHeader;
	[Post.SAMRSamprLmOwfPasswordHeaderPointer = LmOwfPasswordHeader.BufferPtr.ReferentID ? LmOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader LmOwfPasswordHeader;
	[Post.SAMRSamprNtOwfPasswordHeaderPointer = NtOwfPasswordHeader.BufferPtr.ReferentID ? NtOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader NtOwfPasswordHeader;
	[Post.SAMRSamprPrivateDataHeaderPointer = PrivateDataHeader.BufferPtr.ReferentID ? PrivateDataHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader PrivateDataHeader;

	Struct SAMRSamprSrSecurityDescriptor = FormatString("%s",PointerToSecurityDescriptor.toString)
	{
		UINT32 Length;
		[Post.SAMRSamprPointerToSecurityDescriptor = PointerToSecurityDescriptor.ReferentID ? PointerToSecurityDescriptor.ReferentID : 0]
		NdrPtr PointerToSecurityDescriptor;
	}

	UINT32 UserId;
	UINT32 PrimaryGroupId;
	SAMRUserAccountControl UserAccountControl;
	SAMRWhichFields WhichFields;

	Struct SAMRSamprLogonHoursHeader = FormatString("%s",SamrUnitsPerWeekTable( UnitsPerWeek,FALSE ))
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE );
		[Post.SamprPointerToLogonHours = PointerToLogonHours.ReferentID ? PointerToLogonHours.ReferentID : 0]
		NdrPtr PointerToLogonHours;
	}

	UINT16 BadPasswordCount;
	UINT16 LogonCount;
	UINT16 CountryCode;
	UINT16 CodePage;

	BOOLEAN LmPasswordPresent;
	BOOLEAN NtPasswordPresent;
	BOOLEAN PasswordExpired;
	BOOLEAN PrivateDataSensitive;

	SAMRSamprEncryptedUserPassword SAMRSamprEncryptedUserPassword;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SAMRSamprUserNameHeaderPointer > 0: NdrWideString UserName;
	}

	Switch {
		Case SAMRSamprFullNameHeaderPointer > 0: NdrWideString FullName;
	}

	Switch {
		Case SAMRSamprHomeDirectoryHeaderPointer > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SAMRSamprHomeDirectoryDriveHeaderPointer> 0: NdrWideString HomeDirectoryDrive;
	}

	Switch {
		Case SAMRSamprScriptPathHeaderPointer> 0: NdrWideString ScriptPath;
	}

	Switch {
		Case SAMRSamprProfilePathHeaderPointer > 0: NdrWideString ProfilePath;
	}

	Switch {
		Case SAMRSamprAdminCommentHeaderPointer > 0: NdrWideString AdminComment;
	}

	Switch {
		Case SAMRSamprWorkStationsHeaderPointer > 0: NdrWideString WorkStations;
	}

	Switch {
		Case SAMRSamprUserCommentHeaderPointer > 0: NdrWideString UserComment;
	}

	Switch {
		Case SAMRSamprParametersHeaderPointer > 0: NdrWideString Parameters;
	}

	Switch {
		Case SAMRSamprLmOwfPasswordHeaderPointer > 0: NdrWideString LmOwfPassword;
	}

	Switch {
		Case SAMRSamprNtOwfPasswordHeaderPointer > 0: NdrWideString NtOwfPassword;
	}

	Switch {
		Case SAMRSamprPrivateDataHeaderPointer > 0: NdrWideString PrivateData;
	}

	Switch {
		Case SAMRSamprPointerToSecurityDescriptor > 0: SID( TRUE ) SecurityDescriptor;
	}

	Switch
	{
		Case SAMRSamprPointerToLogonHours > 0:
		Struct SAMRSamprLogonHours
		{
			NdrConformantVarying ArrayInfo;
			BLOB( ArrayInfo.ActualCount ) LogonHours;
		}
	}
}

//
//	SAMPR_USER_INTERNAL5_INFORMATION
//	Alignment: None
//
[SamprUserInformationSummary = FormatString( "PasswordExpired: %s", PasswordExpired.toString )]
Struct SAMRSamprUserInternal5Information = FormatString( "PasswordExpired: %s", PasswordExpired.toString )
{
	SAMRSamprEncryptedUserPassword UserPassword;
	BOOLEAN PasswordExpired;
}

//
//	Sampr_ENCRYPTED_USER_PASSWORD_NEW
//	Alignment: NDR
//
[SamprUserInformationSummary = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString )]
Struct SAMRSamprUserInternal4InformationNew = FormatString( "UserName: %s, FullName: %s, UserId: %u, PrimaryGroupId: %u, HomeDirectory: %s, HomeDirectoryDrive: %s", UserName.toString, FullName.toString, UserId, PrimaryGroupId, HomeDirectory.toString, HomeDirectoryDrive.toString )
{
	FILETIME LastLogon;
	FILETIME LastLogoff;
	FILETIME PasswordLastSet;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			SAMROldLargeInteger AccountExpires = FormatString( "Account never expires" );
		};

		Default:
		Struct {
			FILETIME AccountExpires;
		};
	}
	FILETIME PasswordCanChange;
	Switch
	{
		Case (UINT64(FrameData,Offset) == 0x7FFFFFFFFFFFFFFF) || (UINT64(FrameData,Offset) == 0x0000000000000000):
		Struct {
			FILETIME PasswordMustChange = FormatString( "Password never expires" );
		};

		Default:
		Struct {
			FILETIME PasswordMustChange;
		};
	}

	[Post.SAMRSamprUserNameHeaderPointer = UserNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserNameHeader;
	[Post.SAMRSamprFullNameHeaderPointer = FullNameHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader FullNameHeader;
	[Post.SAMRSamprHomeDirectoryHeaderPointer = HomeDirectoryHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryHeader;
	[Post.SAMRSamprHomeDirectoryDriveHeaderPointer = HomeDirectoryDriveHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader HomeDirectoryDriveHeader;
	[Post.SAMRSamprScriptPathHeaderPointer = ScriptPathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ScriptPathHeader;
	[Post.SAMRSamprProfilePathHeaderPointer = ProfilePathHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ProfilePathHeader;
	[Post.SAMRSamprAdminCommentHeaderPointer = AdminCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader AdminCommentHeader;
	[Post.SAMRSamprWorkStationsHeaderPointer = WorkStationsHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader WorkStationsHeader;
	[Post.SAMRSamprUserCommentHeaderPointer = UserCommentHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader UserCommentHeader;
	[Post.SAMRSamprParametersHeaderPointer = ParametersHeader.BufferPtr.ReferentID]
	NdrUnicodeStringHeader ParametersHeader;
	[Post.SAMRSamprLmOwfPasswordHeaderPointer = LmOwfPasswordHeader.BufferPtr.ReferentID ? LmOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader LmOwfPasswordHeader;
	[Post.SAMRSamprNtOwfPasswordHeaderPointer = NtOwfPasswordHeader.BufferPtr.ReferentID ? NtOwfPasswordHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader NtOwfPasswordHeader;
	[Post.SAMRSamprPrivateDataHeaderPointer = PrivateDataHeader.BufferPtr.ReferentID ? PrivateDataHeader.BufferPtr.ReferentID : 0]
	NdrUnicodeStringHeader PrivateDataHeader;

	Struct SAMRSamprSrSecurityDescriptor = FormatString("%s",PointerToSecurityDescriptor.toString)
	{
		UINT32 Length;
		[Post.SAMRSamprPointerToSecurityDescriptor = PointerToSecurityDescriptor.ReferentID ? PointerToSecurityDescriptor.ReferentID : 0]
		NdrPtr PointerToSecurityDescriptor;
	}

	UINT32 UserId;
	UINT32 PrimaryGroupId;
	SAMRUserAccountControl UserAccountControl;
	SAMRWhichFields WhichFields;

	Struct SAMRSamprLogonHoursHeader = FormatString("%s",SamrUnitsPerWeekTable( UnitsPerWeek,FALSE ))
	{
		UINT32 UnitsPerWeek = SamrUnitsPerWeekTable( this,TRUE );
		[Post.SAMRSamprPointerToLogonHours = PointerToLogonHours.ReferentID ? PointerToLogonHours.ReferentID : 0]
		NdrPtr PointerToLogonHours;
	}

	UINT16 BadPasswordCount;
	UINT16 LogonCount;
	UINT16 CountryCode;
	UINT16 CodePage;

	BOOLEAN LmPasswordPresent;
	BOOLEAN NtPasswordPresent;
	BOOLEAN PasswordExpired;
	BOOLEAN PrivateDataSensitive;
	SAMRSamprEncryptedUserPasswordNew SAMRSamprEncryptedUserPassword;
	Switch
	{
		case Property.MSRPCNdr64: Align8 pad;
	}
	Switch {
		Case SAMRSamprUserNameHeaderPointer > 0: NdrWideString UserName;
	}

	Switch {
		Case SAMRSamprFullNameHeaderPointer > 0: NdrWideString FullName;
	}

	Switch {
		Case SAMRSamprHomeDirectoryHeaderPointer > 0: NdrWideString HomeDirectory;
	}

	Switch {
		Case SAMRSamprHomeDirectoryDriveHeaderPointer> 0: NdrWideString HomeDirectoryDrive;
	}

	Switch {
		Case SAMRSamprScriptPathHeaderPointer> 0: NdrWideString ScriptPath;
	}

	Switch {
		Case SAMRSamprProfilePathHeaderPointer > 0: NdrWideString ProfilePath;
	}

	Switch {
		Case SAMRSamprAdminCommentHeaderPointer > 0: NdrWideString AdminComment;
	}

	Switch {
		Case SAMRSamprWorkStationsHeaderPointer > 0: NdrWideString WorkStations;
	}

	Switch {
		Case SAMRSamprUserCommentHeaderPointer > 0: NdrWideString UserComment;
	}

	Switch {
		Case SAMRSamprParametersHeaderPointer > 0: NdrWideString Parameters;
	}

	Switch {
		Case SAMRSamprLmOwfPasswordHeaderPointer > 0: NdrWideString LmOwfPassword;
	}

	Switch {
		Case SAMRSamprNtOwfPasswordHeaderPointer > 0: NdrWideString NtOwfPassword;
	}

	Switch {
		Case SAMRSamprPrivateDataHeaderPointer > 0: NdrWideString PrivateData;
	}

	Switch {
		Case SAMRSamprPointerToSecurityDescriptor > 0: SID( TRUE ) SecurityDescriptor;
	}

	Switch
	{
		Case SAMRSamprPointerToLogonHours > 0:
		Struct SAMRSamprLogonHours
		{
			NdrConformantVarying ArrayInfo;
			BLOB( ArrayInfo.ActualCount ) LogonHours;
		}
	}

}

[SamprUserInformationSummary = FormatString("PasswordExpired: %s",PasswordExpired.toString)]
Struct SAMRSamprUserInternal5InformationNew = FormatString("PasswordExpired: %s",PasswordExpired.toString)
{	
	SAMRSamprEncryptedUserPasswordNew UserPassword;
	BOOLEAN PasswordExpired;
}

Table SamrUnitsPerWeekTable( Value,Description )
{
	Switch( Value )
	{
		Case 0x00000000: FormatString( "%u %s",Value,Description?"Number of minutes in a week":"" );
		Case 0x00000007: FormatString( "%u - SamDaysPerWeek %s",Value,Description?"Number of days in a week":"" );
		Case 0x000000A8: FormatString( "%u - SamHoursPerWeek %s",Value,Description?"Number of hours in a week":"");
		Case 0x00002760: FormatString( "%u - SamMinutesPerWeek %s",Value,Description?"Number of minutes in a week":"" );
		Default        : FormatString( "%u - %s",Value,Description?"No Description Available":"" );
	}
}

//
// _RPC_STRING
// Alignment NdrAlign
//
Struct SAMRRpcString = FormatString( "%s", RPCString.ToString )
{
	UINT16 Length;
	UINT16 MaximumLength;
	NdrPtr Pointer;
	Switch
	{
		Case Pointer.ReferentID > 0: 
			Struct RPCString = String
			{
				NdrConformantVarying ConformantArray;
				Switch {
					Case ConformantArray.ActualCount > 0: AsciiString( ConformantArray.ActualCount ) String;
				}
			}
	}
}

//
// _RPC_STRING_Ptr
// Alignment None
//
Struct SAMRRpcStringPtr = FormatString( "%s", RPCString.ToString )
{
	NdrPtr Pointer;
	Switch
	{
		Case Pointer.ReferentID > 0: SAMRRpcString RPCString;
	}
}

Struct SAMRWhichFields
{
	UINT32 Flags
	{
		Switch( Property.MSRPCByteOrder )
		{
			Case LittleEndian:
				Struct
				{
					UINT32 UserName: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_USERNAME" : "Not set");
					UINT32 FullName: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_FULLNAME" : "Not set");
					UINT32 UserId: 1 = FormatString( "			  (%s) %s", this.ToBitString, this ? "USER_ALL_USERID" : "Not set");
					UINT32 PrimaryGroupId: 1 = FormatString( "    (%s) %s", this.ToBitString, this ? "USER_ALL_PRIMARYGROUPID" : "Not set");
					UINT32 AdminComment: 1 = FormatString( "      (%s) %s", this.ToBitString, this ? "USER_ALL_ADMINCOMMENT" : "Not set");
					UINT32 UserComment: 1 = FormatString( "       (%s) %s", this.ToBitString, this ? "USER_ALL_USERCOMMENT" : "Not set");
					UINT32 HomeDirectory: 1 = FormatString( "     (%s) %s", this.ToBitString, this ? "USER_ALL_HOMEDIRECTORY" : "Not set");
					UINT32 HomeDirectoryDrive: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_HOMEDIRECTORYDRIVE" : "Not set");
					UINT32 ScriptPath: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_SCRIPTPATH" : "Not set");
					UINT32 ProfilePath: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PROFILEPATH" : "Not set");
					UINT32 WorkStations: 1 = FormatString( "      (%s) %s", this.ToBitString, this ? "USER_ALL_WORKSTATIONS" : "Not set");
					UINT32 LastLogon: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LASTLOGON" : "Not set");
					UINT32 LastLogoff: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LASTLOGOFF" : "Not set");
					UINT32 LogonHours: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LOGONHOURS" : "Not set");
					UINT32 BadPasswordCount: 1 = FormatString( "  (%s) %s", this.ToBitString, this ? "USER_ALL_BADPASSWORDCOUNT" : "Not set");
					UINT32 LogonCount: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LOGONCOUNT" : "Not set");
					UINT32 PasswordCanChange: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDCANCHANGE" : "Not set");
					UINT32 PasswordMustChange: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDMUSTCHANGE" : "Not set");
					UINT32 PasswordLastSet: 1 = FormatString( "   (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDLASTSET" : "Not set");
					UINT32 AccountExpires: 1 = FormatString( "    (%s) %s", this.ToBitString, this ? "USER_ALL_ACCOUNTEXPIRES" : "Not set");
					UINT32 UserAccountControl: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_USERACCOUNTCONTROL" : "Not set");
					UINT32 Parameters: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PARAMETERS" : "Not set");
					UINT32 CountryCode: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_COUNTRYCODE" : "Not set");
					UINT32 CodePage: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_CODEPAGE" : "Not set");
					UINT32 NtPasswordPresent: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_NTPASSWORDPRESENT" : "Not set");
					UINT32 LmPasswordPresent: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_LMPASSWORDPRESENT" : "Not set");
					UINT32 PrivateData: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PRIVATEDATA" : "Not set");
					UINT32 PasswordExpired: 1 = FormatString( "   (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDEXPIRED" : "Not set");
					UINT32 SecurityDescriptor: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_SECURITYDESCRIPTOR" : "Not set");
					UINT32 Undefinedmask: 3 = FormatString( "     (%s)", this.ToBitString );
				}
			Case BigEndian:
				Struct
				{
					UINT32 Undefinedmask: 3 = FormatString( "     (%s)", this.ToBitString );
					UINT32 SecurityDescriptor: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_SECURITYDESCRIPTOR" : "Not set");
					UINT32 PasswordExpired: 1 = FormatString( "   (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDEXPIRED" : "Not set");
					UINT32 PrivateData: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PRIVATEDATA" : "Not set");
					UINT32 LmPasswordPresent: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_LMPASSWORDPRESENT" : "Not set");
					UINT32 NtPasswordPresent: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_NTPASSWORDPRESENT" : "Not set");
					UINT32 CodePage: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_CODEPAGE" : "Not set");
					UINT32 CountryCode: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_COUNTRYCODE" : "Not set");
					UINT32 Parameters: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PARAMETERS" : "Not set");
					UINT32 UserAccountControl: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_USERACCOUNTCONTROL" : "Not set");
					UINT32 AccountExpires: 1 = FormatString( "    (%s) %s", this.ToBitString, this ? "USER_ALL_ACCOUNTEXPIRES" : "Not set");
					UINT32 PasswordLastSet: 1 = FormatString( "   (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDLASTSET" : "Not set");
					UINT32 PasswordMustChange: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDMUSTCHANGE" : "Not set");
					UINT32 PasswordCanChange: 1 = FormatString( " (%s) %s", this.ToBitString, this ? "USER_ALL_PASSWORDCANCHANGE" : "Not set");
					UINT32 LogonCount: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LOGONCOUNT" : "Not set");
					UINT32 BadPasswordCount: 1 = FormatString( "  (%s) %s", this.ToBitString, this ? "USER_ALL_BADPASSWORDCOUNT" : "Not set");
					UINT32 LogonHours: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LOGONHOURS" : "Not set");
					UINT32 LastLogoff: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LASTLOGOFF" : "Not set");
					UINT32 LastLogon: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_LASTLOGON" : "Not set");
					UINT32 WorkStations: 1 = FormatString( "      (%s) %s", this.ToBitString, this ? "USER_ALL_WORKSTATIONS" : "Not set");
					UINT32 ProfilePath: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_PROFILEPATH" : "Not set");
					UINT32 ScriptPath: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_SCRIPTPATH" : "Not set");
					UINT32 HomeDirectoryDrive: 1 = FormatString( "(%s) %s", this.ToBitString, this ? "USER_ALL_HOMEDIRECTORYDRIVE" : "Not set");
					UINT32 HomeDirectory: 1 = FormatString( "     (%s) %s", this.ToBitString, this ? "USER_ALL_HOMEDIRECTORY" : "Not set");
					UINT32 UserComment: 1 = FormatString( "       (%s) %s", this.ToBitString, this ? "USER_ALL_USERCOMMENT" : "Not set");
					UINT32 AdminComment: 1 = FormatString( "      (%s) %s", this.ToBitString, this ? "USER_ALL_ADMINCOMMENT" : "Not set");
					UINT32 PrimaryGroupId: 1 = FormatString( "    (%s) %s", this.ToBitString, this ? "USER_ALL_PRIMARYGROUPID" : "Not set");
					UINT32 UserId: 1 = FormatString( "			  (%s) %s", this.ToBitString, this ? "USER_ALL_USERID" : "Not set");
					UINT32 FullName: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_FULLNAME" : "Not set");
					UINT32 UserName: 1 = FormatString( "		  (%s) %s", this.ToBitString, this ? "USER_ALL_USERNAME" : "Not set");
				}
		}
	}
}
